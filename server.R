# Define server logic 
shinyServer(function(input, output, session) {
    
    ## For Input Log
    track_usage(store_null(console = FALSE))
    
    ## Tab 1 - Input Files
    # 1) Input Clinical Patient File from cBioPortal: can specify header, sep, quote and Tab3_Segment_CNA_Yes_or_No of lines to skip (default = tab, double quote, skip 4)
    dataInputClinicalP <- metaReactive2({req(input$Input_Patient_File)
        metaExpr({read.csv(..(input$Input_Patient_File$datapath), header = ..(input$Tab1_Clin_Header_Yes_or_No), sep = ..(input$Tab1_Clin_Separator), quote = ..(input$Tab1_Clin_Quote), na.strings=c(""," ","NA"), skip = ..(input$Tab1_Clin_Skip_Lines))}) })
    
    Patient_Validated <- metaReactive2({
        validate(need(!is.null(input$Input_Patient_File), "Please input clinical patient file."))
        validate(need(ncol(dataInputClinicalP()) > 2, "Inputted file only has one column, please select file delimiters and options carefully."))
        validate(need("PATIENT_ID" %in% colnames(dataInputClinicalP()), "Inputted file does not have patient identification information (PATIENT_ID) - Are you using the right file?"))
        metaExpr({..(dataInputClinicalP()) }) })
    
    output$ClinicalP <- metaRender(renderDataTable, {
        datatable(..(Patient_Validated()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "410px"))})
    
    Tot_Pat_Col <- metaReactive2({if(is.null(input$Input_Patient_File)){
        return(NULL)} else { metaExpr({ncol(..(dataInputClinicalP())) }) } })
    
    Tot_Pat_Row <- metaReactive2({if(is.null(input$Input_Patient_File)){
        return(NULL)} else { metaExpr({nrow(..(dataInputClinicalP())) }) } })
    
    output$TotalC <- metaRender(renderPrint, {..(Tot_Pat_Col())})
    output$TotalR <- metaRender(renderPrint, {..(Tot_Pat_Row())})
    
    # 2) Input Clinical Sample File from cBioPortal: can specify header, sep, quote and Tab3_Segment_CNA_Yes_or_No of lines to skip (default = tab, double quote, skip 4)
    dataInputClinicalS <- metaReactive2({req(input$Input_Sample_File)  
        metaExpr({read.csv(..(input$Input_Sample_File$datapath), header = ..(input$Tab1_Sample_Header_Yes_or_No), sep = ..(input$Tab1_Sample_Separator), quote = ..(input$Tab1_Sample_Quote), na.strings=c(""," ","NA"), skip = ..(input$Tab1_Sample_Skip_Lines))})})
    
    Sample_Validated <- metaReactive2({
        validate(need(!is.null(input$Input_Sample_File), "Please input clinical patient file."))
        validate(need(ncol(dataInputClinicalS()) > 2, "Inputted file only has one column, please select file delimiters and options carefully."))
        validate(need("PATIENT_ID" %in% colnames(dataInputClinicalS()), "Inputted file does not have patient identification information (PATIENT_ID) - Are you using the right file?"))
        metaExpr({..(dataInputClinicalS()) }) })
    
    output$ClinicalS <- metaRender(renderDataTable, {
        datatable(..(Sample_Validated()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "410px"))})
    
    Tot_Samp_Col <- metaReactive2({if(is.null(input$Input_Sample_File)){
        return(NULL)} else { metaExpr({ncol(..(dataInputClinicalS())) }) } })
    
    Tot_Samp_Row <- metaReactive2({if(is.null(input$Input_Sample_File)){
        return(NULL)} else { metaExpr({nrow(..(dataInputClinicalS())) }) } })
    
    output$TotalC1 <- metaRender(renderPrint, {..(Tot_Samp_Col())})
    output$TotalR2 <- metaRender(renderPrint, {..(Tot_Samp_Row())})
    
    # 3) Merge two files (patient and sample -> clinical data) -> Make sure PATIENT ID column exists 
    dataClinical <- metaReactive2({if(is.null(input$Input_Sample_File) & !is.null(input$Input_Patient_File)) {
        validate(need(ncol(dataInputClinicalP()) > 2, "Inputted file only has one column, please select file delimiters and options carefully."))
        validate(need("PATIENT_ID" %in% colnames(dataInputClinicalP()), "Inputted file does not have PATIENT_ID information - Are you using the right file?"))
        metaExpr({..(dataInputClinicalP())} )}
        else if(is.null(input$Input_Patient_File) & !is.null(input$Input_Sample_File)){
            validate(need(ncol(dataInputClinicalS()) > 2, "Inputted file only has one column, please select file delimiters and options carefully."))
            validate(need("PATIENT_ID" %in% colnames(dataInputClinicalS()), "Inputted file does not have PATIENT_ID information - Are you using the right file?"))
            metaExpr({..(dataInputClinicalS())})
        } else if(is.null(input$Input_Sample_File) & is.null(input$Input_Patient_File)){
            return(NULL)} else { 
                validate(need(ncol(dataInputClinicalP()) > 2, "Inputted file only has one column, please select file delimiters and options carefully."))
                validate(need("PATIENT_ID" %in% colnames(dataInputClinicalP()), "Inputted file does not have PATIENT_ID information - Are you using the right file?"))
                validate(need(ncol(dataInputClinicalS()) > 2, "Inputted file only has one column, please select file delimiters and options carefully."))
                validate(need("PATIENT_ID" %in% colnames(dataInputClinicalS()), "Inputted file does not have PATIENT_ID information - Are you using the right file?"))
                metaExpr({merge(..(dataInputClinicalP()), ..(dataInputClinicalS()), by.x = "PATIENT_ID", by.y="PATIENT_ID") }) }})
    
    output$ClinicalAll <- metaRender(renderDataTable, {
        datatable(..(dataClinical()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "410px"))})
    
    
    # 4) Input CNA File from cBioPortal: can specify header, sep, quote and Tab3_Segment_CNA_Yes_or_No of lines to skip (default = tab, double quote, skip 0) 
    dataInputCNA <- metaReactive2({req(input$Input_CNA_File) 
        metaExpr({read.csv(..(input$Input_CNA_File$datapath), header = ..(input$Tab1_CNA_Header_Yes_or_No), sep = ..(input$Tab1_CNA_Separator), quote = ..(input$Tab1_CNA_Quote), check.names = F, na.strings=c(""," ","NA"), skip=..(input$Tab1_CNA_Skip_Lines))})})
    
    CNA_Validated <- metaReactive2({
        validate(need(!is.null(input$Input_CNA_File), "Please input CNA data file."))
        validate(need(ncol(dataInputCNA()) > 1, "Inputted file only has one column, please select file delimiters and options carefully."))
        validate(need("Hugo_Symbol" %in% colnames(dataInputCNA()), "Inputted file does not have Gene information (Hugo_Symbol) - Are you using the right file?"))
        metaExpr({..(dataInputCNA()) }) })
    
    output$CNA = metaRender(renderDataTable, {
        datatable(..(CNA_Validated()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "390px"))})
    
    Tot_CNA_Col <- metaReactive2({if(is.null(input$Input_CNA_File)){
        return(NULL)} else { metaExpr({ncol(..(dataInputCNA())) }) } })
    
    Tot_CNA_Row <- metaReactive2({if(is.null(input$Input_CNA_File)){
        return(NULL)} else { metaExpr({nrow(..(dataInputCNA())) }) } })
    
    output$TotalCCNA <- metaRender(renderPrint, {..(Tot_CNA_Col())})
    output$TotalRCNA <- metaRender(renderPrint, {..(Tot_CNA_Row())})
    
    # 5) Input MAF File from cBioPortal: can specify header, sep, quote and Tab3_Segment_CNA_Yes_or_No of lines to skip (default = tab, double quote, skip 1) 
    dataInputMAF <- metaReactive2({req(input$Input_MAF_File) 
        metaExpr({read.csv(..(input$Input_MAF_File$datapath), header = ..(input$Tab1_MAF_Header_Yes_or_No), sep = ..(input$Tab1_MAF_Separator), quote = ..(input$Tab1_MAF_Quote), na.strings=c(""," ","NA"), skip=..(input$Tab1_MAF_Skip_Lines), row.names = NULL)})})
    
    MAF_Validated <- metaReactive2({
        validate(need(!is.null(input$Input_MAF_File), "Please input MAF file."))
        validate(need(ncol(dataInputMAF()) > 1, "Inputted file only has one column, please select file delimiters and options carefully."))
        validate(need("Hugo_Symbol" %in% colnames(dataInputMAF()), "Inputted file does not have Gene information (Hugo_Symbol) - Are you using the right file?"))
        metaExpr({..(dataInputMAF()) }) })
    
    output$MAF = metaRender(renderDataTable, {
        datatable(..(MAF_Validated()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "390px"))})
    
    Tot_MAF_Col <- metaReactive2({if(is.null(input$Input_MAF_File)){
        return(NULL)} else { metaExpr({ncol(..(dataInputMAF())) }) } })
    
    Tot_MAF_Row <- metaReactive2({if(is.null(input$Input_MAF_File)){
        return(NULL)} else { metaExpr({nrow(..(dataInputMAF())) }) } })
    
    output$TotalCMAF <- metaRender(renderPrint, {..(Tot_MAF_Col())})
    output$TotalRMAF <- metaRender(renderPrint, {..(Tot_MAF_Row())})
    
    ## Tab 2 - Exploratory Tables
    # Tables to further explore and compare Input Files
    # 1) Clinical/Sample Files
    observe({vchoices <- c(names(dataClinical()), "None Selected")
    updateSelectizeInput(session, "Tab2_Clin_Column1_Variable", choices = vchoices, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_Clin_Column2_Variable", choices = vchoices, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_Clin_Column3_Variable", choices = vchoices, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_Clin_Column4_Variable", choices = vchoices, selected = "None Selected", server = TRUE) 
    updateSelectizeInput(session, "Tab2_Clin_Column5_Variable", choices = vchoices, selected = "None Selected", server = TRUE)})
    
    # renderDataTable is reactive to a change in the input data or the selected columns
    Clinical_Table <- metaReactive2({
        if(input$Tab2_Clin_Column1_Variable == "None Selected" & input$Tab2_Clin_Column2_Variable == "None Selected" & input$Tab2_Clin_Column3_Variable == "None Selected" & input$Tab2_Clin_Column4_Variable == "None Selected" & input$Tab2_Clin_Column5_Variable == "None Selected"){
            validate("Please select data columns to analyse in sequential order i.e. select column 1 to column 5.")
            return(NULL)
        } else if(input$Tab2_Clin_Column1_Variable != "None Selected" & input$Tab2_Clin_Column2_Variable == "None Selected" & input$Tab2_Clin_Column3_Variable == "None Selected" & input$Tab2_Clin_Column4_Variable == "None Selected" & input$Tab2_Clin_Column5_Variable == "None Selected"){
            metaExpr({as_tibble(..(dataClinical())[,c(..(input$Tab2_Clin_Column1_Variable))]) %>% mutate(!!..(input$Tab2_Clin_Column1_Variable) := value) %>% select(!!..(input$Tab2_Clin_Column1_Variable))})
        } else if(input$Tab2_Clin_Column1_Variable != "None Selected" & input$Tab2_Clin_Column2_Variable != "None Selected" & input$Tab2_Clin_Column3_Variable == "None Selected" & input$Tab2_Clin_Column4_Variable == "None Selected" & input$Tab2_Clin_Column5_Variable == "None Selected"){
            metaExpr({..(dataClinical())[,c(..(input$Tab2_Clin_Column1_Variable), ..(input$Tab2_Clin_Column2_Variable))]})
        } else if(input$Tab2_Clin_Column1_Variable != "None Selected" & input$Tab2_Clin_Column2_Variable != "None Selected" & input$Tab2_Clin_Column3_Variable != "None Selected" & input$Tab2_Clin_Column4_Variable == "None Selected" & input$Tab2_Clin_Column5_Variable == "None Selected"){
            metaExpr({..(dataClinical())[,c(..(input$Tab2_Clin_Column1_Variable), ..(input$Tab2_Clin_Column2_Variable), ..(input$Tab2_Clin_Column3_Variable))]})
        } else if(input$Tab2_Clin_Column1_Variable != "None Selected" & input$Tab2_Clin_Column2_Variable != "None Selected" & input$Tab2_Clin_Column3_Variable != "None Selected" & input$Tab2_Clin_Column4_Variable != "None Selected" & input$Tab2_Clin_Column5_Variable == "None Selected"){
            metaExpr({..(dataClinical())[,c(..(input$Tab2_Clin_Column1_Variable), ..(input$Tab2_Clin_Column2_Variable), ..(input$Tab2_Clin_Column3_Variable), ..(input$Tab2_Clin_Column4_Variable))]})
        } else if(input$Tab2_Clin_Column1_Variable != "None Selected" & input$Tab2_Clin_Column2_Variable != "None Selected" & input$Tab2_Clin_Column3_Variable != "None Selected" & input$Tab2_Clin_Column4_Variable != "None Selected" & input$Tab2_Clin_Column5_Variable != "None Selected"){
            metaExpr({..(dataClinical())[,c(..(input$Tab2_Clin_Column1_Variable), ..(input$Tab2_Clin_Column2_Variable), ..(input$Tab2_Clin_Column3_Variable), ..(input$Tab2_Clin_Column4_Variable), ..(input$Tab2_Clin_Column5_Variable))]})
        } else{validate("Please select data columns in sequential order i.e. column 1 to column 5.")
            return(NULL)}
    })
    
    output$Clinical_Table = metaRender(renderDataTable, {
        DT::datatable(..(Clinical_Table()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "450px"))})
    
    # 2) Table CNA 
    observe({vchoicesCNA <- c(names(dataInputCNA()), "None Selected")
    updateSelectizeInput(session, "Tab2_CNA_Column1_Variable", choices = vchoicesCNA, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_CNA_Column2_Variable", choices = vchoicesCNA, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_CNA_Column3_Variable", choices = vchoicesCNA, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_CNA_Column4_Variable", choices = vchoicesCNA, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_CNA_Column5_Variable", choices = vchoicesCNA, selected = "None Selected", server = TRUE)})
    
    CNA_Table <- metaReactive2({
        if(input$Tab2_CNA_Column1_Variable== "None Selected" & input$Tab2_CNA_Column2_Variable == "None Selected" & input$Tab2_CNA_Column3_Variable== "None Selected" & input$Tab2_CNA_Column4_Variable == "None Selected" & input$Tab2_CNA_Column5_Variable == "None Selected"){
            return(validate("Please select data columns to analyse in sequential order i.e. select column 1 to column 5."))
        } else if(input$Tab2_CNA_Column1_Variable!= "None Selected" & input$Tab2_CNA_Column2_Variable == "None Selected" & input$Tab2_CNA_Column3_Variable== "None Selected" & input$Tab2_CNA_Column4_Variable == "None Selected" & input$Tab2_CNA_Column5_Variable == "None Selected"){
            metaExpr({as_tibble(..(dataInputCNA())[,c(..(input$Tab2_CNA_Column1_Variable))]) %>% mutate(!!..(input$Tab2_CNA_Column1_Variable) := value) %>% select(!!..(input$Tab2_CNA_Column1_Variable))})
        } else if(input$Tab2_CNA_Column1_Variable != "None Selected" & input$Tab2_CNA_Column2_Variable != "None Selected" & input$Tab2_CNA_Column3_Variable== "None Selected" & input$Tab2_CNA_Column4_Variable == "None Selected" & input$Tab2_CNA_Column5_Variable == "None Selected"){
            metaExpr({ ..(dataInputCNA())[,c(..(input$Tab2_CNA_Column1_Variable), ..(input$Tab2_CNA_Column2_Variable))]})
        } else if(input$Tab2_CNA_Column1_Variable != "None Selected" & input$Tab2_CNA_Column2_Variable != "None Selected" & input$Tab2_CNA_Column3_Variable != "None Selected" & input$Tab2_CNA_Column4_Variable == "None Selected" & input$Tab2_CNA_Column5_Variable == "None Selected"){
            metaExpr({ ..(dataInputCNA())[,c(..(input$Tab2_CNA_Column1_Variable), ..(input$Tab2_CNA_Column2_Variable), ..(input$Tab2_CNA_Column3_Variable))]})
        } else if(input$Tab2_CNA_Column1_Variable != "None Selected" & input$Tab2_CNA_Column2_Variable != "None Selected" & input$Tab2_CNA_Column3_Variable != "None Selected" & input$Tab2_CNA_Column4_Variable != "None Selected" & input$Tab2_CNA_Column5_Variable == "None Selected"){
            metaExpr({ ..(dataInputCNA())[,c(..(input$Tab2_CNA_Column1_Variable), ..(input$Tab2_CNA_Column2_Variable), ..(input$Tab2_CNA_Column3_Variable), ..(input$Tab2_CNA_Column4_Variable))]})
        } else if(input$Tab2_CNA_Column1_Variable != "None Selected" & input$Tab2_CNA_Column2_Variable != "None Selected" & input$Tab2_CNA_Column3_Variable != "None Selected" & input$Tab2_CNA_Column4_Variable != "None Selected" & input$Tab2_CNA_Column5_Variable != "None Selected"){
            metaExpr({ ..(dataInputCNA())[,c(..(input$Tab2_CNA_Column1_Variable), ..(input$Tab2_CNA_Column2_Variable), ..(input$Tab2_CNA_Column3_Variable), ..(input$Tab2_CNA_Column4_Variable), ..(input$Tab2_CNA_Column5_Variable))]})
        } else{validate("Please select data columns in sequential order i.e. column 1 to column 5.")}
    })
    
    output$CNA_Table = metaRender(renderDataTable, {
        DT::datatable(..(CNA_Table()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "450px"))})
    
    # 3) Table - Mutation (MAF)
    observe({vchoicesMAF <- c(names(dataInputMAF()), "None Selected")
    updateSelectizeInput(session, "Tab2_MAF_Column1_Variable", choices = vchoicesMAF, selected ="None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_MAF_Column2_Variable", choices = vchoicesMAF, selected ="None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_MAF_Column3_Variable", choices = vchoicesMAF, selected ="None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_MAF_Column4_Variable", choices = vchoicesMAF, selected ="None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab2_MAF_Column5_Variable", choices = vchoicesMAF, selected ="None Selected", server = TRUE)})
    
    MAF_Table <- metaReactive2({
        if(input$Tab2_MAF_Column1_Variable == "None Selected" & input$Tab2_MAF_Column2_Variable == "None Selected" & input$Tab2_MAF_Column3_Variable == "None Selected" & input$Tab2_MAF_Column4_Variable == "None Selected" & input$Tab2_MAF_Column5_Variable == "None Selected"){
            return(validate("Please select data columns to analyse in sequential order i.e. select column 1 to column 5."))
        } else if(input$Tab2_MAF_Column1_Variable != "None Selected" & input$Tab2_MAF_Column2_Variable == "None Selected" & input$Tab2_MAF_Column3_Variable == "None Selected" & input$Tab2_MAF_Column4_Variable == "None Selected" & input$Tab2_MAF_Column5_Variable == "None Selected"){
            metaExpr({as_tibble(..(dataInputMAF())[,c(..(input$Tab2_MAF_Column1_Variable))]) %>% mutate(!!..(input$Tab2_MAF_Column1_Variable) := value) %>% select(!!..(input$Tab2_MAF_Column1_Variable))})
        } else if(input$Tab2_MAF_Column1_Variable != "None Selected" & input$Tab2_MAF_Column2_Variable != "None Selected" & input$Tab2_MAF_Column3_Variable == "None Selected" & input$Tab2_MAF_Column4_Variable == "None Selected" & input$Tab2_MAF_Column5_Variable == "None Selected"){
            metaExpr({ ..(dataInputMAF())[,c(..(input$Tab2_MAF_Column1_Variable), ..(input$Tab2_MAF_Column2_Variable))] })
        } else if(input$Tab2_MAF_Column1_Variable != "None Selected" & input$Tab2_MAF_Column2_Variable != "None Selected" & input$Tab2_MAF_Column3_Variable != "None Selected" & input$Tab2_MAF_Column4_Variable == "None Selected" & input$Tab2_MAF_Column5_Variable == "None Selected"){
            metaExpr({  ..(dataInputMAF())[,c(..(input$Tab2_MAF_Column1_Variable), ..(input$Tab2_MAF_Column2_Variable), ..(input$Tab2_MAF_Column3_Variable))] })
        } else if(input$Tab2_MAF_Column1_Variable != "None Selected" & input$Tab2_MAF_Column2_Variable != "None Selected" & input$Tab2_MAF_Column3_Variable != "None Selected" & input$Tab2_MAF_Column4_Variable != "None Selected" & input$Tab2_MAF_Column5_Variable == "None Selected"){
            metaExpr({ ..(dataInputMAF())[,c(..(input$Tab2_MAF_Column1_Variable), ..(input$Tab2_MAF_Column2_Variable), ..(input$Tab2_MAF_Column3_Variable), ..(input$Tab2_MAF_Column4_Variable ))] })
        } else if(input$Tab2_MAF_Column1_Variable != "None Selected" & input$Tab2_MAF_Column2_Variable != "None Selected" & input$Tab2_MAF_Column3_Variable != "None Selected" & input$Tab2_MAF_Column4_Variable != "None Selected" & input$Tab2_MAF_Column5_Variable != "None Selected"){
            metaExpr({ ..(dataInputMAF())[,c(..(input$Tab2_MAF_Column1_Variable), ..(input$Tab2_MAF_Column2_Variable), ..(input$Tab2_MAF_Column3_Variable), ..(input$Tab2_MAF_Column4_Variable), ..(input$Tab2_MAF_Column5_Variable))] })
        } else{validate("Please select data columns in sequential order i.e. column 1 to column 5.")}
    })
    
    output$MAF_Table = metaRender(renderDataTable, {
        DT::datatable(..(MAF_Table()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "450px"))})
    
    ## Tab 3 - Subset/Recode/Format Data 
    # 1) Recode numeric/categorical variables
    observe({vchoicesCheckNum <- c(names(dataClinical()))
    updateSelectInput(session, "Tab3_Variables_to_Numeric", choices = vchoicesCheckNum)
    updateSelectInput(session, "Tab3_Variables_to_Factor", choices = vchoicesCheckNum)})
    
    Formatted_Data <- metaReactive2({
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({..(dataClinical()) %>% mutate_at(..(input$Tab3_Variables_to_Numeric), funs(as.numeric(.))) %>% mutate_at(..(input$Tab3_Variables_to_Factor), funs(as.factor(.))) # Convert columns to numeric/factor
        }) })

    # Check Data Types i.e. Int/Character
    output$DataTypes = metaRender(renderPrint, {str(..(Formatted_Data()), list.len=ncol(..(Formatted_Data())))})
    
    # Check Levels - No NA factor levels and all right 'Type' etc.
    output$DataLevels = metaRender(renderPrint, {sapply(..(Formatted_Data()), levels)})
    
    # 2) Subset Based on 3 categorical variables and 2 numerical values?
    # Categorical 
    # Subset data based on variable factor levels
    observe({vchoicesSub <- names(dataClinical())
    updateSelectInput(session, "Tab3_Subset_Variable_1", choices = vchoicesSub, selected = vchoicesSub[1])
    updateSelectInput(session, "Tab3_Subset_Variable_2", choices = vchoicesSub, selected = vchoicesSub[2])
    updateSelectInput(session, "Tab3_Subset_Variable_3", choices = vchoicesSub, selected = vchoicesSub[3])})
    
    observe({vchoicesSub1 <- c(levels(Formatted_Data()[,input$Tab3_Subset_Variable_1]), "None Selected")
    updateSelectInput(session, "Tab3_Subset_Variable_Levels_1", choices = vchoicesSub1, selected = "None Selected")})
    
    observe({vchoicesSub2 <- c(levels(Formatted_Data()[,input$Tab3_Subset_Variable_2]), "None Selected")
    updateSelectInput(session, "Tab3_Subset_Variable_Levels_2", choices = vchoicesSub2, selected = "None Selected")})
    
    observe({vchoicesSub3 <- c(levels(Formatted_Data()[,input$Tab3_Subset_Variable_3]), "None Selected")
    updateSelectInput(session, "Tab3_Subset_Variable_Levels_3", choices = vchoicesSub3, selected = "None Selected")})
    
    Clinical_Sub_1  <- metaReactive2({ 
        validate(need(!is.null(input$Tab3_Subset_Variable_Levels_1) & !is.null(input$Tab3_Subset_Variable_Levels_2) & !is.null(input$Tab3_Subset_Variable_Levels_3), "Please make sure there are no NULL selected variable levels"))
    if(input$Tab3_Subset_Variable_Levels_1 == "None Selected" & input$Tab3_Subset_Variable_Levels_2 == "None Selected" & input$Tab3_Subset_Variable_Levels_3 == "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({..(Formatted_Data()) })
    } else if (input$Tab3_Subset_Variable_Levels_1 != "None Selected" & input$Tab3_Subset_Variable_Levels_2 == "None Selected" & input$Tab3_Subset_Variable_Levels_3 == "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({filter(..(Formatted_Data()), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_1)] %in% ..(input$Tab3_Subset_Variable_Levels_1))})
    } else if (input$Tab3_Subset_Variable_Levels_1 == "None Selected" & input$Tab3_Subset_Variable_Levels_2 != "None Selected" & input$Tab3_Subset_Variable_Levels_3 == "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({filter(..(Formatted_Data()), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_2)] %in% ..(input$Tab3_Subset_Variable_Levels_2)) })
    } else if (input$Tab3_Subset_Variable_Levels_1 == "None Selected" & input$Tab3_Subset_Variable_Levels_2 == "None Selected" & input$Tab3_Subset_Variable_Levels_3 != "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({filter(..(Formatted_Data()), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_3)] %in% ..(input$Tab3_Subset_Variable_Levels_3)) })
    } else if (input$Tab3_Subset_Variable_Levels_1 != "None Selected" & input$Tab3_Subset_Variable_Levels_2 != "None Selected" & input$Tab3_Subset_Variable_Levels_3 == "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({filter(..(Formatted_Data()), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_1)] %in% ..(input$Tab3_Subset_Variable_Levels_1), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_2)] %in% ..(input$Tab3_Subset_Variable_Levels_2))})
    } else if (input$Tab3_Subset_Variable_Levels_1 != "None Selected" & input$Tab3_Subset_Variable_Levels_2 == "None Selected" & input$Tab3_Subset_Variable_Levels_3 != "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({filter(..(Formatted_Data()), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_1)] %in% ..(input$Tab3_Subset_Variable_Levels_1), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_3)] %in% ..(input$Tab3_Subset_Variable_Levels_3))})
    } else if (input$Tab3_Subset_Variable_Levels_1 == "None Selected" & input$Tab3_Subset_Variable_Levels_2 != "None Selected" & input$Tab3_Subset_Variable_Levels_3 != "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({filter(..(Formatted_Data()), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_2)] %in% ..(input$Tab3_Subset_Variable_Levels_2), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_3)] %in% ..(input$Tab3_Subset_Variable_Levels_3))})
    } else {
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({filter(..(Formatted_Data()), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_1)] %in% ..(input$Tab3_Subset_Variable_Levels_1), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_2)] %in% ..(input$Tab3_Subset_Variable_Levels_2), ..(Formatted_Data())[,..(input$Tab3_Subset_Variable_3)] %in% ..(input$Tab3_Subset_Variable_Levels_3))}) } })
    
    Clinical_Sub <- metaReactive2({metaExpr({
        ..(Clinical_Sub_1()) %>% mutate_at(..(input$Tab3_Variables_to_Factor), funs(as.factor(as.character(.)))) 
    }) })
    
    output$TableRecode1 = metaRender(renderDataTable, {
        datatable(..(Clinical_Sub()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "350px"))})
    
    output$TableLevels = metaRender(renderPrint, {sapply(..(Clinical_Sub())[,c(..(input$Tab3_Subset_Variable_1), ..(input$Tab3_Subset_Variable_2), ..(input$Tab3_Subset_Variable_3))], levels)})
    
    # 3) Carry out Survival recoding
    observe({vchoicesRecode <- c(names(dataClinical()), "None Selected")
    updateSelectInput(session, "Tab3_Select_OS_Column", choices = vchoicesRecode, selected = "None Selected")
    updateSelectInput(session, "Tab3_Select_DSS_Column", choices = vchoicesRecode, selected = "None Selected")})
    
    dataClinicalSurv <- metaReactive2({ if(input$Tab3_Recode_Survival_Yes_or_No == "Yes" & is.null(dataClinical())){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        return(NULL)
    } else if(input$Tab3_Select_OS_Column == "None Selected" & input$Tab3_Select_DSS_Column == "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({..(Clinical_Sub())})
    } else if(input$Tab3_Recode_Survival_Yes_or_No == "Yes" & !is.null(dataClinical()) & input$Tab3_Select_OS_Column != "None Selected" & input$Tab3_Select_DSS_Column == "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({..(Clinical_Sub()) %>% mutate(OS = ifelse(..(Clinical_Sub())[,..(input$Tab3_Select_OS_Column)] == ..(input$Tab3_OS_Event), 1, 0))})
    } else if(input$Tab3_Recode_Survival_Yes_or_No == "Yes" & !is.null(dataClinical()) & input$Tab3_Select_OS_Column == "None Selected" & input$Tab3_Select_DSS_Column != "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({ ..(Clinical_Sub()) %>% mutate(DSS = ifelse(..(Clinical_Sub())[,..(input$Tab3_Select_DSS_Column)] == ..(input$Tab3_DSS_Event), 1, 0)) })
    } else if(input$Tab3_Recode_Survival_Yes_or_No == "Yes" & !is.null(dataClinical()) & input$Tab3_Select_OS_Column != "None Selected" & input$Tab3_Select_DSS_Column != "None Selected"){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({..(Clinical_Sub()) %>%  mutate(OS = ifelse(..(Clinical_Sub())[,..(input$Tab3_Select_OS_Column)] == ..(input$Tab3_OS_Event), 1, 0), DSS = ifelse(..(Clinical_Sub())[,..(input$Tab3_Select_DSS_Column)] == ..(input$Tab3_DSS_Event), 1, 0)) })
    } else if(input$Tab3_Recode_Survival_Yes_or_No == "No" & !is.null(dataClinical())){
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        metaExpr({..(Clinical_Sub())})
    } else {
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
        return(NULL) } })
    
    TableRecode_Pre =  metaReactive2({
        if(input$Tab3_Recode_Survival_Yes_or_No == "No" | (input$Tab3_Select_OS_Column == "None Selected" & input$Tab3_Select_DSS_Column == "None Selected")){
            validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
            metaExpr({ ..(dataClinicalSurv())})}
        else if(input$Tab3_Recode_Survival_Yes_or_No != "No" & (input$Tab3_Select_OS_Column != "None Selected" & input$Tab3_Select_DSS_Column == "None Selected")){
            validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
            metaExpr({..(dataClinicalSurv())[,c(..(input$Tab3_Select_OS_Column), "OS")]} )}
        else if(input$Tab3_Recode_Survival_Yes_or_No != "No" & (input$Tab3_Select_OS_Column == "None Selected" & input$Tab3_Select_DSS_Column != "None Selected")){
            validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
            metaExpr({ ..(dataClinicalSurv())[,c(..(input$Tab3_Select_DSS_Column), "DSS")]})}
        else if(input$Tab3_Recode_Survival_Yes_or_No != "No" & (input$Tab3_Select_OS_Column != "None Selected" & input$Tab3_Select_DSS_Column != "None Selected")){
            validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File), "Please input clinical patient and/or sample file."))
            metaExpr({..(dataClinicalSurv())[,c(..(input$Tab3_Select_OS_Column), ..(input$Tab3_Select_DSS_Column), "OS","DSS")]}) }})
    
    output$TableRecode = metaRender(renderDataTable, {
        datatable(..(TableRecode_Pre()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "350px"))})
    
    # CNA Score Calculation 
    CNA_Clin <- metaReactive2({
        if(is.null(input$Input_CNA_File)){validate(need(input$Input_CNA_File, "Please input CNA summary file."))
        } else if(!is.null(input$Input_CNA_File) & input$Tab3_CNA_of_Interest == "None" & (!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File))){
            validate(need("PATIENT_ID" %in% colnames(dataInputCNA()) | input$Tab3_CNA_of_Interest != "None", "Please choose to calculate CNA Scores, select specific genes to analyse or make sure CNA file has PATIENT_ID column."))
            metaExpr({CNA_Status <- merge(..(dataClinicalSurv()), ..(dataInputCNA()), by.x = "PATIENT_ID", by.y = "PATIENT_ID") # Make sure both files have PATIENT_ID 
            CNA_Status })
        } else if(!is.null(input$Input_CNA_File) & is.null(input$Input_Sample_File) & is.null(input$Input_Patient_File) & input$Tab3_CNA_of_Interest == "Single Gene"){
            gene_list <- unlist(str_split(c(input$Tab3_Select_Genes), pattern = ", "))
            if(sum(gene_list %in% dataInputCNA()[,c("Hugo_Symbol")]) != length(gene_list)){
                return(NULL)
            } else {
            metaExpr({gene_list <- unlist(str_split(c(..(input$Tab3_Select_Genes)), pattern = ", ")) 
            Gene <- ..(dataInputCNA()) %>% filter(Hugo_Symbol %in% gene_list)
            CNA_Status <- as.data.frame(t(Gene[,..(input$Tab3_CNA_Start_Column):ncol(Gene)]))
            names(CNA_Status) <- gene_list
            CNA_Status$PATIENT_ID <- rownames(CNA_Status)
            rownames(CNA_Status) = NULL
            CNA_Status <- CNA_Status %>% select(PATIENT_ID, gene_list)
            CNA_Status}) }
        } else if(!is.null(input$Input_CNA_File) & (!is.null(input$Input_Sample_File) | !is.null(input$Input_Patient_File)) & input$Tab3_CNA_of_Interest == "Single Gene"){
            gene_list <- unlist(str_split(c(input$Tab3_Select_Genes), pattern = ", "))
            if(sum(gene_list %in% dataInputCNA()[,c("Hugo_Symbol")]) != length(gene_list)){
                return(NULL)
            } else {
            metaExpr({gene_list <- unlist(str_split(c(..(input$Tab3_Select_Genes)), pattern = ", ")) 
            Gene <- ..(dataInputCNA()) %>% filter(Hugo_Symbol %in% gene_list)
            CNA_Status <- as.data.frame(t(Gene[,..(input$Tab3_CNA_Start_Column):ncol(Gene)]))
            names(CNA_Status) <- gene_list
            CNA_Status$PATIENT_ID <- rownames(CNA_Status)
            rownames(CNA_Status) = NULL
            CNA_Status <- CNA_Status %>% select(PATIENT_ID, gene_list)
            # Merge with Clinical 
            CNA_Status <- merge(..(dataClinicalSurv()), CNA_Status, by.x = "PATIENT_ID", by.y = "PATIENT_ID") # Make sure both files have PATIENT_ID 
            CNA_Status }) }
        } else if(!is.null(input$Input_CNA_File) & is.null(input$Input_Sample_File) & is.null(input$Input_Patient_File) & input$Tab3_CNA_of_Interest == "CNA Score"){
            validate(need(is.numeric(dataInputCNA()[,input$Tab3_CNA_Start_Column]), "Please make sure CNA start column is numeric."))
            metaExpr({ PATIENT_ID <- colnames(..(dataInputCNA())[,..(input$Tab3_CNA_Start_Column):ncol(..(dataInputCNA()))]) 
            Scores <- as.data.frame(PATIENT_ID)
            Scores$CNA_Score <- colSums(abs(..(dataInputCNA())[,..(input$Tab3_CNA_Start_Column):ncol(..(dataInputCNA()))]), na.rm = ..(input$Tab3_CNA_Remove_NAs_Yes_or_No))
            Scores <- na.omit(Scores) # remove NAs (Could have All and CCA)
            
            # CNA Score Amp and Del for Each Patient CCA (Apply)
            Scores$Amp_Score <- na.omit(apply(X = ..(dataInputCNA())[,..(input$Tab3_CNA_Start_Column):ncol(..(dataInputCNA()))], MARGIN = 2, function(x) sum(x[x > 0], na.rm = ..(input$Tab3_CNA_Remove_NAs_Yes_or_No))))
            Scores$Del_Score <- na.omit(apply(X = ..(dataInputCNA())[,..(input$Tab3_CNA_Start_Column):ncol(..(dataInputCNA()))], MARGIN = 2, function(x) sum(x[x < 0], na.rm = ..(input$Tab3_CNA_Remove_NAs_Yes_or_No))))
            Scores$Del_Score <- abs(Scores$Del_Score)
            
            if(..(input$Tab3_Segment_CNA_Yes_or_No) == "TRUE"){ Scores$Score_Quartile <- split_quantile(x=Scores$CNA_Score, type = ..(input$Tab3_Number_of_Segments))
            CNA_Metrics <- Scores %>% select(c("PATIENT_ID", "CNA_Score", "Amp_Score", "Del_Score", "Score_Quartile"))} # Segment Scores 
            else{CNA_Metrics <- Scores %>% select(c("PATIENT_ID", "CNA_Score", "Amp_Score", "Del_Score"))}
            }) 
            
        } else if(!is.null(input$Input_CNA_File) & (!is.null(input$Input_Sample_File) | !is.null(input$Input_Patient_File)) & input$Tab3_CNA_of_Interest == "CNA Score"){
            validate(need(is.numeric(dataInputCNA()[,input$Tab3_CNA_Start_Column]), "Please make sure CNA start column is numeric."))
            metaExpr({ PATIENT_ID <- colnames(..(dataInputCNA())[,..(input$Tab3_CNA_Start_Column):ncol(..(dataInputCNA()))]) 
            Scores <- as.data.frame(PATIENT_ID)
            Scores$CNA_Score <- colSums(abs(..(dataInputCNA())[,..(input$Tab3_CNA_Start_Column):ncol(..(dataInputCNA()))]), na.rm = ..(input$Tab3_CNA_Remove_NAs_Yes_or_No))
            Scores <- na.omit(Scores) # remove NAs (Could have All and CCA)
            
            # CNA Score Amp and Del for Each Patient CCA (Apply)
            Scores$Amp_Score <- na.omit(apply(X = ..(dataInputCNA())[,..(input$Tab3_CNA_Start_Column):ncol(..(dataInputCNA()))], MARGIN = 2, function(x) sum(x[x > 0], na.rm = ..(input$Tab3_CNA_Remove_NAs_Yes_or_No))))
            Scores$Del_Score <- na.omit(apply(X = ..(dataInputCNA())[,..(input$Tab3_CNA_Start_Column):ncol(..(dataInputCNA()))], MARGIN = 2, function(x) sum(x[x < 0], na.rm = ..(input$Tab3_CNA_Remove_NAs_Yes_or_No))))
            Scores$Del_Score <- abs(Scores$Del_Score) 
            
            if(..(input$Tab3_Segment_CNA_Yes_or_No) == "TRUE"){
                Scores$Score_Quartile <- split_quantile(x=Scores$CNA_Score, type = ..(input$Tab3_Number_of_Segments)) # Segment Scores 
            }
            
            CNA_Metrics <- Scores 
            CNA_Metrics_All <- merge(..(dataClinicalSurv()), CNA_Metrics, by.x = "PATIENT_ID", by.y = "PATIENT_ID") # Make sure both files have PATIENT_ID 
            
            if(..(input$Tab3_Segment_CNA_Yes_or_No) == "TRUE"){
                CNA_Metrics_All$Subset_Score_Quartile <- split_quantile(x=CNA_Metrics_All$CNA_Score, type = ..(input$Tab3_Number_of_Segments)) # Segment Scores 
            } 
            
            CNA_Metrics_All })
        } else if(!is.null(input$Input_CNA_File) & is.null(input$Input_Sample_File) & is.null(input$Input_Patient_File) & input$Tab3_CNA_of_Interest == "None"){ 
            metaExpr({ return(..(dataInputCNA())) })}
        else {validate(need(input$Input_CNA_File, "Please input CNA summary file."))
            metaExpr({ return(NULL) })}
    })
    
    output$TableCNACalc = metaRender(renderDataTable, {
        datatable(..(CNA_Clin()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "400px"))})
    
    # Dataset after all the manipulations -> use for everything going forward
    Whole_Data <- metaReactive2({
        validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
        if(is.null(input$Input_CNA_File) & is.null(input$Input_Patient_File) & is.null(input$Input_Sample_File)){
            return(NULL)
        } else if(!is.null(input$Input_CNA_File)){
            metaExpr({..(CNA_Clin()) })
        } else if(is.null(input$Input_CNA_File) & (!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File))){
            metaExpr({..(dataClinicalSurv())}) }
    })
    
    output$TableData = metaRender(renderDataTable, {
        datatable(..(Whole_Data()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "400px"))})
    
    output$Tab3_Download_File = downloadHandler('Processed_Data.txt', content = function(file) {
        write.table(Whole_Data(), file, sep=input$Tab3_Download_File_Separator, quote = input$Tab3_Download_File_Quote, row.names = input$Tab3_Download_File_Row_Names)
    })
    
    ## Tab 4 - Exploratory Plots 
    # Exploratory Plots:  (1. Boxplot, 2. Scatterplots, 3. Barplot, 4. Histogram, 4. Density Plot)
    # 1) Box plots 
    
    observe({vchoicesbox1 <- c(names(Whole_Data()), "None Selected")
    updateSelectizeInput(session, "Tab4_Boxplot_Select_X_Variable", choices = vchoicesbox1, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab4_Boxplot_Select_Y_Variable", choices = vchoicesbox1, selected = "None Selected", server = TRUE)})
    
    Box1 <- metaReactive2({
        if(is.null(Whole_Data()) | input$Tab4_Boxplot_Select_X_Variable == "None Selected" | input$Tab4_Boxplot_Select_Y_Variable == "None Selected"){
            ggplot() + theme_void()
        } else {
            metaExpr({ggplot(data = ..(Whole_Data()), mapping = aes(x = ..(Whole_Data())[,..(input$Tab4_Boxplot_Select_X_Variable)], y = ..(Whole_Data())[,..(input$Tab4_Boxplot_Select_Y_Variable)], color = ..(Whole_Data())[,..(input$Tab4_Boxplot_Select_X_Variable)])) +
                    geom_boxplot(varwidth = ..(input$Tab4_Boxplot_by_Sample_Size), na.rm = TRUE, aes(fill = ..(Whole_Data())[,..(input$Tab4_Boxplot_Select_X_Variable)]), alpha = 0.35) + geom_jitter(alpha = 0.3) + ggtitle(..(input$Tab4_Boxplot_Title)) + 
                    ylab(..(input$Tab4_Boxplot_Y_Axis_Title)) + xlab(..(input$Tab4_Boxplot_X_Axis_Title)) + theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) + 
                    stat_summary(fun.data = give.n, geom = "text", fun = median, col = "black", size=4) + labs(fill = ..(input$Tab4_Boxplot_Legend_Title)) + scale_color_discrete(guide = FALSE) + scale_x_discrete(na.translate = ..(input$Tab4_Boxplot_Display_NAs)) + theme(legend.position = ..(input$Tab4_Boxplot_Legend_Position))}) }})
    
    output$plot3 = metaRender(renderPlot, { ..(Box1()) })
    
    # Download Button
    output$Tab4_Download_Boxplot <- downloadHandler(filename = function(){paste("Boxplot",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab4_Boxplot_Width, height = input$Tab4_Boxplot_Height)
        print(Box1())
        dev.off()})
    
    # 2) Scatterplots 
    observe({vchoicesASS  <-  c(names(Whole_Data()), "None Selected")
    updateSelectizeInput(session, "Tab4_Scatterplot_Select_X_Variable", choices = vchoicesASS, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab4_Scatterplot_Select_Y_Variable", choices = vchoicesASS, selected = "None Selected", server = TRUE) 
    updateSelectizeInput(session, "Tab4_Scatterplot_Select_Colour_Var", choices = vchoicesASS, selected = "None Selected", server = TRUE)})
    
    Scat1 <- metaReactive2({
        if(is.null(Whole_Data()) | input$Tab4_Scatterplot_Select_X_Variable == "None Selected" | input$Tab4_Scatterplot_Select_Y_Variable == "None Selected"){
            ggplot() + theme_void()
        } else if(input$Tab4_Scatterplot_Select_X_Variable != "None Selected" & input$Tab4_Scatterplot_Select_Y_Variable != "None Selected" & input$Tab4_Scatterplot_Select_Colour_Var == "None Selected"){
            metaExpr({ggplot(..(Whole_Data())) + geom_point(aes(x=..(Whole_Data())[,..(input$Tab4_Scatterplot_Select_X_Variable)], y=..(Whole_Data())[,..(input$Tab4_Scatterplot_Select_Y_Variable)]), size = 1.5) + 
                    ggtitle(..(input$Tab4_Scatterplot_Title)) + ylab(..(input$Tab4_Scatterplot_Y_Axis_Title)) + xlab(..(input$Tab4_Scatterplot_X_Axis_Title)) + theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) + 
                    scale_colour_discrete(..(input$Tab4_Scatterplot_Legend_Title), na.translate = ..(input$Tab4_Scatterplot_Display_NAs)) + theme(legend.position = input$Tab4_Scatterplot_Legend_Position)}) 
        } else {
            metaExpr({ggplot(..(Whole_Data())) + geom_point(aes(x=..(Whole_Data())[,..(input$Tab4_Scatterplot_Select_X_Variable)], y=..(Whole_Data())[,..(input$Tab4_Scatterplot_Select_Y_Variable)], colour = ..(Whole_Data())[,..(input$Tab4_Scatterplot_Select_Colour_Var)]), size = 1.5) + 
                    ggtitle(..(input$Tab4_Scatterplot_Title)) + ylab(..(input$Tab4_Scatterplot_Y_Axis_Title)) + xlab(..(input$Tab4_Scatterplot_X_Axis_Title)) + theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) + 
                    scale_colour_discrete(..(input$Tab4_Scatterplot_Legend_Title), na.translate = ..(input$Tab4_Scatterplot_Display_NAs)) + theme(legend.position = ..(input$Tab4_Scatterplot_Legend_Position))}) }})
    
    output$Scatterplot1 = metaRender(renderPlot, { ..(Scat1()) })
    
    # Download Button
    output$Tab4_Download_Scatterplot <- downloadHandler(filename = function(){paste("Scatterplot",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab4_Scatterplot_Width, height = input$Tab4_Scatterplot_Height)
        print(Scat1())
        dev.off()})
    
    # 3) Barplots 
    observe({vchoicesASS <-  c(names(Whole_Data()), "None Selected")
    updateSelectizeInput(session, "Tab4_Barplot_Select_X_Variable", choices = vchoicesASS, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab4_Barplot_Select_Y_Variable", choices = vchoicesASS, selected = "None Selected", server = TRUE)})
    
    Bar1 <- metaReactive2({
        if(is.null(Whole_Data()) | input$Tab4_Barplot_Select_X_Variable == "None Selected" | input$Tab4_Barplot_Select_Y_Variable == "None Selected"){
            ggplot() + theme_void() } 
        else{metaExpr({ggplot(..(Whole_Data()), aes(x=factor(..(Whole_Data())[,..(input$Tab4_Barplot_Select_X_Variable)]), fill=factor(..(Whole_Data())[,..(input$Tab4_Barplot_Select_Y_Variable)]))) + geom_bar(position="fill") + 
                    ggtitle(..(input$Tab4_Barplot_Title)) + ylab(..(input$Tab4_Barplot_Y_Axis_Title)) + xlab(..(input$Tab4_Barplot_X_Axis_Title))  + theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) +  
                    labs(fill = ..(input$Tab4_Barplot_Legend_Title)) + theme(legend.position = ..(input$Tab4_Barplot_Legend_Position)) + scale_x_discrete(na.translate = ..(input$Tab4_Barplot_Display_NAs))}) }})
    
    output$Association3 = metaRender(renderPlot, { ..(Bar1()) })
    
    # Download Button
    output$Tab4_Download_Barplot <- downloadHandler(filename = function(){paste("Barplot",'.png',sep='')}, content = function(file){
        png(file,  width = input$Tab4_Barplot_Width, height = input$Tab4_Barplot_Height)
        print(Bar1())
        dev.off()})
    
    # 4) Histograms and Density Plots -> CNA Score Density 
    observe({vchoicesDist <-  c(names(Whole_Data()), "None Selected")
    updateSelectizeInput(session, "Tab4_Select_Plot_Variable", choices = vchoicesDist, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab4_Both_Plot_Select_Facet_Variable", choices = vchoicesDist, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab4_Histogram_Select_Facet_Variable", choices = vchoicesDist, selected = "None Selected", server = TRUE)})
    
    # Histogram 
    observe({vchoicesASS <-  c(names(Whole_Data()), "None Selected")
    updateSelectizeInput(session, "Tab4_Density_Plot_Select_Fill_Variable", choices = vchoicesASS, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab4_Both_Plot_Select_Fill_Variable", choices = vchoicesASS, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab4_Histogram_Select_Fill_Variable", choices = vchoicesASS, selected = "None Selected", server = TRUE)})
    
    CNAHistogram <-  metaReactive2({
        if(is.null(Whole_Data()) | input$Tab4_Select_Plot_Variable  == "None Selected"){
            ggplot() + theme_void()
        } else if(input$Tab4_Select_Plot_Variable != "None Selected" & input$Tab4_Histogram_Select_Fill_Variable == "None Selected"){
           metaExpr({ggplot(..(Whole_Data()), aes(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)])) + geom_histogram(aes(color = 'Color', fill= "Color"), show.legend = FALSE, binwidth = ..(input$Tab4_Histogram_Number_of_Bins), alpha = ..(input$Tab4_Histogram_Alpha)) + 
                    ggtitle(..(input$Tab4_Histogram_Title)) + ylab(..(input$Tab4_Histogram_Y_Axis_Title)) + xlab(..(input$Tab4_Histogram_X_Axis_Title)) + scale_color_manual(values = c("Color" = "#2ac0db")) +  scale_fill_manual(values = c("Color" = "#2ac0db")) + 
                    theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15))})
        } else {
            if(input$Tab4_Histogram_Display_NAs == FALSE){metaExpr({ Data <- completeFun(..(Whole_Data()), c(..(input$Tab4_Histogram_Select_Fill_Variable)))
                ggplot(Data, aes(Data[,..(input$Tab4_Select_Plot_Variable)])) + geom_histogram(aes(fill = Data[,..(input$Tab4_Histogram_Select_Fill_Variable)], color = Data[,..(input$Tab4_Histogram_Select_Fill_Variable)]), binwidth = ..(input$Tab4_Histogram_Number_of_Bins), alpha = ..(input$Tab4_Histogram_Alpha)) + 
                    ggtitle(..(input$Tab4_Histogram_Title)) + ylab(..(input$Tab4_Histogram_Y_Axis_Title)) + xlab(..(input$Tab4_Histogram_X_Axis_Title)) + theme(legend.position = ..(input$LegPlainhisttab)) +
                    theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) +
                    theme(legend.position = ..(input$Tab4_Histogram_Legend_Position)) + scale_fill_discrete(..(input$Tab4_Histogram_Legend_Title)) +
                    scale_color_discrete(..(input$Tab4_Histogram_Legend_Title))})
                } else {metaExpr({ggplot(..(Whole_Data()), aes(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)])) + geom_histogram(aes(fill = ..(Whole_Data())[,..(input$Tab4_Histogram_Select_Fill_Variable)], color = ..(Whole_Data())[,..(input$Tab4_Histogram_Select_Fill_Variable)]), binwidth = ..(input$Tab4_Histogram_Number_of_Bins), alpha = ..(input$Tab4_Histogram_Alpha)) + 
                        ggtitle(..(input$Tab4_Histogram_Title)) + ylab(..(input$Tab4_Histogram_Y_Axis_Title)) + xlab(..(input$Tab4_Histogram_X_Axis_Title)) + theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                        theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) + theme(legend.position = ..(input$Tab4_Histogram_Legend_Position)) + scale_fill_discrete(..(input$Tab4_Histogram_Legend_Title)) +
                        scale_color_discrete(..(input$Tab4_Histogram_Legend_Title))})
            }} })
    
    output$CNAHist = metaRender(renderPlot, { ..(CNAHistogram()) })
    
    output$Tab4_Download_Histogram <- downloadHandler(filename = function(){paste("Histogram",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab4_Histogram_Width, height = input$Tab4_Histogram_Height)
        print(CNAHistogram())
        dev.off()})
    
    # Facet Wrap
    long_fileHist <- metaReactive2({if(input$Tab4_Faceted_Histogram_Display_NAs == FALSE){
        metaExpr({melt(..(Whole_Data())[,c(..(input$Tab4_Select_Plot_Variable), ..(input$Tab4_Histogram_Select_Facet_Variable))]) %>% filter(!is.na(eval(parse(text = ..(input$Tab4_Histogram_Select_Facet_Variable))))) })
    } else { 
        metaExpr({melt(..(Whole_Data())[,c(..(input$Tab4_Select_Plot_Variable), ..(input$Tab4_Histogram_Select_Facet_Variable))])})}})
    
    CNAHisttab <- metaReactive2({
        if(is.null(Whole_Data()) | input$Tab4_Histogram_Select_Facet_Variable  == "None Selected"){
            ggplot() + theme_void()
        } else {metaExpr({ggplot(..(long_fileHist()), aes(x=value)) + geom_histogram(aes(color = factor(..(long_fileHist())[,..(input$Tab4_Histogram_Select_Facet_Variable)]), fill=factor(..(long_fileHist())[,..(input$Tab4_Histogram_Select_Facet_Variable)])), alpha = ..(input$Tab4_Faceted_Histogram_Alpha), binwidth = ..(input$Tab4_Faceted_Histogram_Number_of_Bins)) +
                    facet_wrap(factor(..(long_fileHist())[,..(input$Tab4_Histogram_Select_Facet_Variable)])~., ncol=..(input$Tab4_Faceted_Histogram_Number_of_Columns)) + ggtitle(..(input$Tab4_Faceted_Histogram_Title)) + 
                    ylab(..(input$Tab4_Faceted_Histogram_Y_Axis_Title)) + xlab(..(input$Tab4_Faceted_Histogram_X_Axis_Title)) + theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) + theme(legend.position = ..(input$Tab4_Faceted_Histogram_Legend_Position)) +
                    scale_fill_discrete(..(input$Tab4_Faceted_Histogram_Legend_Title)) + guides(color = FALSE) }) }})
    
    output$CNAHist1 = metaRender(renderPlot, { ..(CNAHisttab()) })
    
    output$Tab4_Download_Faceted_Histogram <- downloadHandler(filename = function(){paste("Histogram_Facet",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab4_Faceted_Histogram_Width, height = input$Tab4_Faceted_Histogram_Height)
        print(CNAHisttab())
        dev.off()})
    
    # Plain Density Plot 
    CNADense <- metaReactive2({
        if(is.null(Whole_Data()) | input$Tab4_Select_Plot_Variable  == "None Selected"){
            ggplot() + theme_void()
        } else if(input$Tab4_Select_Plot_Variable  != "None Selected" & input$Tab4_Density_Plot_Select_Fill_Variable == "None Selected"){
            metaExpr({
            ggplot(..(Whole_Data())) + geom_density(aes(x=..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], color = 'Color', fill= "Color"),  na.rm = ..(input$Tab4_Density_Plot_Display_NAs), alpha = ..(input$Tab4_Density_Plot_Alpha)) + xlab(..(input$Tab4_Density_Plot_X_Axis_Title)) + ylab(..(input$Tab4_Density_Plot_Y_Axis_Title)) + ggtitle(..(input$Tab4_Density_Plot_Title)) + 
                theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) +
                scale_color_manual(values = c("Color" = "#2ac0db")) +  scale_fill_manual(values = c("Color" = "#2ac0db")) + theme(legend.position = "none") + xlim(range(density(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], na.rm = T)$x)) })
        } else { metaExpr({
            if(input$Tab4_Density_Plot_Display_NAs == FALSE){
                Data <- completeFun(..(Whole_Data()), c(..(input$Tab4_Density_Plot_Select_Fill_Variable)))
                ggplot(Data) + geom_density(aes(x=Data[,..(input$Tab4_Select_Plot_Variable)], fill = Data[,..(input$Tab4_Density_Plot_Select_Fill_Variable)], color = Data[,..(input$Tab4_Density_Plot_Select_Fill_Variable)]), alpha = ..(input$Tab4_Density_Plot_Alpha)) + xlab(..(input$Tab4_Density_Plot_X_Axis_Title)) + ylab(..(input$Tab4_Density_Plot_Y_Axis_Title)) + ggtitle(..(input$Tab4_Density_Plot_Title)) + 
                    theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) +
                    theme(legend.position = ..(input$Tab4_Density_Plot_Legend_Position)) + scale_fill_discrete(..(input$Tab4_Density_Plot_Legend_Title)) + scale_color_discrete(..(input$Tab4_Density_Plot_Legend_Title)) + xlim(range(density(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], na.rm = T)$x)) 
            } else {
                    ggplot(..(Whole_Data())) + geom_density(aes(x=..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], fill = ..(Whole_Data())[,..(input$Tab4_Density_Plot_Select_Fill_Variable)], color = ..(Whole_Data())[,..(input$Tab4_Density_Plot_Select_Fill_Variable)]), alpha = ..(input$Tab4_Density_Plot_Alpha)) + xlab(..(input$Tab4_Density_Plot_X_Axis_Title)) + ylab(..(input$Tab4_Density_Plot_Y_Axis_Title)) + ggtitle(..(input$Tab4_Density_Plot_Title)) + 
                        theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                        theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) +
                        theme(legend.position = ..(input$Tab4_Density_Plot_Legend_Position)) + scale_fill_discrete(..(input$Tab4_Density_Plot_Legend_Title)) + scale_color_discrete(..(input$Tab4_Density_Plot_Legend_Title)) + xlim(range(density(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], na.rm = T)$x)) 
            }}) }})
    
    output$CNADist = metaRender(renderPlot, { ..(CNADense()) })
    
    output$Tab4_Download_Density_Plot <- downloadHandler(filename = function(){paste("Density_Plot",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab4_Density_Plot_Width, height = input$Tab4_Density_Plot_Height)
        print(CNADense())
        dev.off()})
    
    # Segmented Density Plot (Works for half, tertiled, quartiles and quintiled data)
    CNADist1Plot <- metaReactive2({
        if(is.null(Whole_Data()) | input$Tab4_Select_Plot_Variable  == "None Selected"){
            ggplot() + theme_void()
        } else if(input$Tab4_Segmented_Density_Plot_Display_Legend == TRUE){
            metaExpr({
                colourCount = ..(input$Tab4_Segmented_Density_Plot_Number_of_Segments)
                getPalette = colorRampPalette(brewer.pal(9, "Blues"))
                lab <- as.character(1:..(input$Tab4_Segmented_Density_Plot_Number_of_Segments))
                
                dt <- data.frame(x=c(1:length(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)])), y=..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)])
                dt <- na.omit(dt)
                dens <- density(dt$y)
                df <- data.frame(x=dens$x, y=dens$y)
                probs1 = c(0:..(input$Tab4_Segmented_Density_Plot_Number_of_Segments)/..(input$Tab4_Segmented_Density_Plot_Number_of_Segments))
                probs <- probs1[-c(1,length(probs1))]
                quantiles <- quantile(dt$y, prob=probs)
                df$quant <- factor(findInterval(df$x,quantiles))
                ggplot(df, aes(x,y)) + geom_line() + geom_ribbon(aes(ymin=0, ymax=y, fill=quant)) + scale_x_continuous(breaks=quantiles) + xlab(..(input$Tab4_Segmented_Density_Plot_X_Axis_Title)) + ylab(..(input$Tab4_Segmented_Density_Plot_Y_Axis_Title)) + ggtitle(..(input$Tab4_Segmented_Density_Plot_Title)) + 
                    theme(legend.position = c(0.9, 0.5)) + theme(legend.key.size = unit(0.9, "cm")) +
                    theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) +
                    scale_fill_manual(values = getPalette(colourCount), labels = lab, name=..(input$Tab4_Segmented_Density_Plot_Legend_Title))})
        } else {
            metaExpr({
               colourCount = ..(input$Tab4_Segmented_Density_Plot_Number_of_Segments)
                getPalette = colorRampPalette(brewer.pal(9, "Blues"))
                
                dt <- data.frame(x=c(1:length(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)])), y=..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)])
                dt <- na.omit(dt)
                dens <- density(dt$y)
                df <- data.frame(x=dens$x, y=dens$y)
                probs1 = c(0:..(input$Tab4_Segmented_Density_Plot_Number_of_Segments)/..(input$Tab4_Segmented_Density_Plot_Number_of_Segments))
                probs <- probs1[-c(1,length(probs1))]
                quantiles <- quantile(dt$y, prob=probs)
                df$quant <- factor(findInterval(df$x,quantiles))
                ggplot(df, aes(x,y)) + geom_line() + geom_ribbon(aes(ymin=0, ymax=y, fill=quant)) + scale_x_continuous(breaks=quantiles) + xlab(..(input$Tab4_Segmented_Density_Plot_X_Axis_Title)) + ylab(..(input$Tab4_Segmented_Density_Plot_Y_Axis_Title)) + ggtitle(..(input$Tab4_Segmented_Density_Plot_Title)) + 
                    theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) +
                    theme(legend.position = c(0.9, 0.5)) + theme(legend.key.size = unit(0.9, "cm")) + scale_fill_manual(values = getPalette(colourCount), name=..(input$Tab4_Segmented_Density_Plot_Legend_Title)) + guides(fill=FALSE)}) }})
    
    output$CNADist1 <- metaRender(renderPlot, { ..(CNADist1Plot()) })
    
    output$Tab4_Download_Segmented_Density_Plot <- downloadHandler(filename = function(){paste("Segmented_Density_Plot",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab4_Segmented_Density_Plot_Width, height = input$Tab4_Segmented_Density_Plot_Height)
        print(CNADist1Plot())
        dev.off()})
    
    # Facet Wrap -> Make new dataset (melt)
    observe({vchoicesDistfacet <- c(names(Whole_Data()), "None Selected")
    updateSelectizeInput(session, "Tab4_Density_Plot_Select_Facet_Variable", choices = vchoicesDistfacet, selected = "None Selected", server = TRUE)})
    
    long_file <- metaReactive2({ if(input$Tab4_Faceted_Density_Plot_Display_NAs == FALSE){
        metaExpr({melt(..(Whole_Data())[,c(..(input$Tab4_Select_Plot_Variable), ..(input$Tab4_Density_Plot_Select_Facet_Variable))]) %>% filter(!is.na(eval(parse(text = ..(input$Tab4_Density_Plot_Select_Facet_Variable)))))
        }) } else { metaExpr({melt(..(Whole_Data())[,c(..(input$Tab4_Select_Plot_Variable), ..(input$Tab4_Density_Plot_Select_Facet_Variable))])})}})
    
    CNADist2Plot <- metaReactive2({
        if(is.null(Whole_Data()) | input$Tab4_Density_Plot_Select_Facet_Variable  == "None Selected"){
            ggplot() + theme_void()
        } else {metaExpr({
            ggplot(..(long_file())) + geom_density(aes(x=value, color = factor(..(long_file())[,..(input$Tab4_Density_Plot_Select_Facet_Variable)]), fill = factor(..(long_file())[,..(input$Tab4_Density_Plot_Select_Facet_Variable)])), alpha = ..(input$Tab4_Faceted_Density_Plot_Alpha)) + facet_wrap(factor(..(long_file())[,..(input$Tab4_Density_Plot_Select_Facet_Variable)])~., ncol=..(input$Tab4_Faceted_Density_Plot_Number_of_Columns)) + ggtitle(..(input$Tab4_Faceted_Density_Plot_Title)) + 
                ylab(..(input$Tab4_Faceted_Density_Plot_Y_Axis_Title)) + xlab(..(input$Tab4_Faceted_Density_Plot_X_Axis_Title)) +
                theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) +
                scale_fill_discrete(name = ..(input$Tab4_Faceted_Density_Plot_Legend_Title)) + xlim(range(density(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], na.rm = T)$x)) + 
                guides(color = FALSE) + theme(legend.position = ..(input$Tab4_Faceted_Density_Plot_Legend_Position))}) }})
    
    output$CNADist2 <- metaRender(renderPlot, { ..(CNADist2Plot()) })
    
    output$Tab4_Download_Faceted_Density_Plot <- downloadHandler(filename = function(){paste("Faceted_Density_Plot",'.png',sep='')}, content = function(file){
        png(file,  width = input$Tab4_Faceted_Density_Plot_Width, height = input$Tab4_Faceted_Density_Plot_Height)
        print(CNADist2Plot())
        dev.off()})
    
    # 3) Both 
    # Plain
    CNABoth <- metaReactive2({
        if(is.null(Whole_Data()) | input$Tab4_Select_Plot_Variable  == "None Selected"){
            ggplot() + theme_void()
        } else if(input$Tab4_Select_Plot_Variable  != "None Selected" & input$Tab4_Both_Plot_Select_Fill_Variable == "None Selected"){
            metaExpr({ 
            ggplot(..(Whole_Data())) + geom_density(aes(x=..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], color = 'Color', fill= "Color"),  na.rm = ..(input$Tab4_Both_Plot_Display_NAs), alpha = ..(input$Tab4_Both_Density_Plot_Alpha)) + 
                geom_histogram(aes(x=..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], y = ..density.., color = "Color", fill="Color"), alpha = ..(input$Tab4_Both_Histogram_Alpha), fill="#2ac0db", position = "identity")  + xlab(..(input$Tab4_Both_Plot_X_Axis_Title)) + ylab(..(input$Tab4_Both_Plot_Y_Axis_Title)) + ggtitle(..(input$Tab4_Both_Plot_Title)) + 
                theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15))  +
                xlim(range(density(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], na.rm = T)$x)) +
                scale_color_manual(values = c("Color" = "#2ac0db")) +  scale_fill_manual(values = c("Color" = "#2ac0db")) + theme(legend.position = "none")})
        } else {metaExpr({
            if(input$Tab4_Both_Plot_Display_NAs == FALSE){
                Data <- completeFun(..(Whole_Data()), c(..(input$Tab4_Both_Plot_Select_Fill_Variable)))
                ggplot(Data) + geom_density(aes(x=Data[,..(input$Tab4_Select_Plot_Variable)], fill = Data[,..(input$Tab4_Both_Plot_Select_Fill_Variable)], color =  Data[,..(input$Tab4_Both_Plot_Select_Fill_Variable)]), alpha = ..(input$Tab4_Both_Density_Plot_Alpha)) + 
                    geom_histogram(aes(x=Data[,..(input$Tab4_Select_Plot_Variable)], y = ..density.., fill = Data[,..(input$Tab4_Both_Plot_Select_Fill_Variable)], color =  Data[,..(input$Tab4_Both_Plot_Select_Fill_Variable)]), alpha = ..(input$Tab4_Both_Histogram_Alpha), position = "identity") + xlab(..(input$Tab4_Both_Plot_X_Axis_Title)) + ylab(..(input$Tab4_Both_Plot_Y_Axis_Title)) + ggtitle(..(input$Tab4_Both_Plot_Title)) + 
                    xlim(range(density(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], na.rm = T)$x)) + theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                    theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15))  +
                    theme(legend.position = ..(input$Tab4_Both_Plot_Legend_Position)) + scale_fill_discrete(..(input$Tab4_Both_Plot_Legend_Title)) + scale_color_discrete(..(input$Tab4_Both_Plot_Legend_Title)) 
            } else {ggplot(..(Whole_Data())) + geom_density(aes(x=..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], fill = ..(Whole_Data())[,..(input$Tab4_Both_Plot_Select_Fill_Variable)], color = ..(Whole_Data())[,..(input$Tab4_Both_Plot_Select_Fill_Variable)]), alpha = ..(input$Tab4_Both_Density_Plot_Alpha)) + 
                        geom_histogram(aes(x=..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], y = ..density.., fill = ..(Whole_Data())[,..(input$Tab4_Both_Plot_Select_Fill_Variable)],  color = ..(Whole_Data())[,..(input$Tab4_Both_Plot_Select_Fill_Variable)]), alpha = ..(input$Tab4_Both_Histogram_Alpha), position = "identity") + xlab(..(input$Tab4_Both_Plot_X_Axis_Title)) + ylab(..(input$Tab4_Both_Plot_Y_Axis_Title)) + ggtitle(..(input$Tab4_Both_Plot_Title)) + 
                        theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                        theme(axis.text.x=element_text(size=15)) +  theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15))  + xlim(range(density(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], na.rm = T)$x)) +
                        theme(legend.position = ..(input$Tab4_Both_Plot_Legend_Position)) + scale_fill_discrete(..(input$Tab4_Both_Plot_Legend_Title)) + scale_color_discrete(..(input$Tab4_Both_Plot_Legend_Title)) 
            }}) } })
    
    output$CNABoth <- metaRender(renderPlot, { ..(CNABoth()) })
    
    output$Tab4_Download_Both_Plot <- downloadHandler(filename = function(){paste("Density_Hist_Plot",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab4_Both_Plot_Width, height = input$Tab4_Both_Plot_Height)
        print(CNABoth())
        dev.off()})
    
    # Facet Wrap
    long_file1 <-  metaReactive2({ if(input$Tab4_Faceted_Both_Plot_Display_NAs == FALSE){
        metaExpr({melt(..(Whole_Data())[,c(..(input$Tab4_Select_Plot_Variable), ..(input$Tab4_Both_Plot_Select_Facet_Variable))]) %>% filter(!is.na(eval(parse(text = ..(input$Tab4_Both_Plot_Select_Facet_Variable)))))
        })} else { metaExpr({melt(..(Whole_Data())[,c(..(input$Tab4_Select_Plot_Variable), ..(input$Tab4_Both_Plot_Select_Facet_Variable))])
        }) }})
    
    CNADist2Plot1 <- metaReactive2({
        if(is.null(Whole_Data()) | input$Tab4_Both_Plot_Select_Facet_Variable  == "None Selected"){
            ggplot() + theme_void()
        } else {metaExpr ({
          ggplot(..(long_file1()), aes(x=value)) + geom_histogram(aes(x=value, y=..density.., color = factor(..(long_file1())[,..(input$Tab4_Both_Plot_Select_Facet_Variable)]),  fill=factor(..(long_file1())[,..(input$Tab4_Both_Plot_Select_Facet_Variable)])), position = "identity", alpha = ..(input$Tab4_Faceted_Both_Histogram_Plot_Alpha)) +
                geom_density(aes(x=value, color = factor(..(long_file1())[,..(input$Tab4_Both_Plot_Select_Facet_Variable)]), fill=factor(..(long_file1())[,..(input$Tab4_Both_Plot_Select_Facet_Variable)])), show.legend = ..(input$Tab4_Faceted_Both_Plot_Legend_Position), alpha= ..(input$Tab4_Faceted_Both_Density_Plot_Alpha)) + facet_wrap(factor(..(long_file1())[,..(input$Tab4_Both_Plot_Select_Facet_Variable)])~., ncol=..(input$Tab4_Faceted_Both_Plot_Number_of_Columns)) + ggtitle(..(input$Tab4_Faceted_Both_Plot_Title)) + 
                ylab(..(input$Tab4_Faceted_Both_Plot_Y_Axis_Title)) + xlab(..(input$Tab4_Faceted_Both_Plot_X_Axis_Title)) +
                theme(plot.title = element_text(hjust = 0.5, size =18)) + theme(axis.title.x = element_text(hjust = 0.5, size=18)) + theme(axis.title.y = element_text(hjust = 0.5, size=18)) + 
                theme(axis.text.x=element_text(size=15)) + theme(axis.text.y=element_text(size=15)) + theme(legend.title = element_text(colour="black", size=15, face="bold")) + theme(strip.text = element_text(size=15)) + theme(legend.text=element_text(size=15)) +
                scale_fill_discrete(name = ..(input$Tab4_Faceted_Both_Plot_Legend_Title)) + xlim(range(density(..(Whole_Data())[,..(input$Tab4_Select_Plot_Variable)], na.rm = T)$x))  + 
                guides(color = FALSE) + theme(legend.position = ..(input$Tab4_Faceted_Both_Plot_Legend_Position))}) }})
    
    output$CNABoth1 <- metaRender(renderPlot, { ..(CNADist2Plot1()) })
    
    # Download
    output$Tab4_Download_Faceted_Both_Plot <- downloadHandler(filename = function(){paste("Faceted_Density_Plot",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab4_Faceted_Both_Plot_Width, height = input$Tab4_Faceted_Both_Plot_Height)
        print(CNADist2Plot1())
        dev.off()})
    
    ## Tab5: Survival Plots 
    # Survival Analysis Tab: 1) Clinical KM Plots
    
    observe({vchoicesSurv1 <- c(names(Whole_Data()), "None Selected")
    updateSelectizeInput(session, "Tab5_KM_Clinical_Survival_Time", choices = vchoicesSurv1, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab5_KM_Clinical_Event_Status", choices = vchoicesSurv1, selected = "None Selected", server = TRUE)
    updateSelectizeInput(session, "Tab5_KM_Clinical_Select_Variable", choices = vchoicesSurv1, selected = "None Selected", server = TRUE)})
    
    surv_data <- metaReactive2({ metaExpr({data.frame(Time = ..(Whole_Data())[[..(input$Tab5_KM_Clinical_Survival_Time)]], Strata = ..(Whole_Data())[[..(input$Tab5_KM_Clinical_Select_Variable)]], Cen  = ..(Whole_Data())[[..(input$Tab5_KM_Clinical_Event_Status)]])}) })
    
    datafit <- metaReactive2({ metaExpr({survfit(Surv(as.numeric(Time), as.numeric(as.character(Cen))) ~ Strata, data = ..(surv_data())) }) })
    
    KMC1 <- metaReactive2({if(is.null(Whole_Data()) | input$Tab5_KM_Clinical_Survival_Time  == "None Selected" | input$Tab5_KM_Clinical_Event_Status  == "None Selected" | input$Tab5_KM_Clinical_Select_Variable  == "None Selected"){
        ggplot() + theme_void()}
        else{ metaExpr({ggsurvplot(..(datafit()), censor.shape="", data = ..(surv_data()), size = 1, conf.int = ..(input$Tab5_KM_Clinical_Display_CI), pval = ..(input$Tab5_KM_Clinical_Display_Pval), risk.table = ..(input$Tab5_KM_Clinical_Display_Risk_Table), legend = c(..(input$Tab5_KM_Clinical_Legend_Position)), xlab = ..(input$Tab5_KM_Clinical_X_Axis_Title), ylab = ..(input$Tab5_KM_Clinical_Y_Axis_Title),
                                   legend.title = ..(input$Tab5_KM_Clinical_Legend_Title), legend.labs = rownames(summary(..(datafit())$table)), pval.size = 6, risk.table.height = 0.25, ggtheme = theme_gray() + theme(plot.title = element_text(size= 18, hjust = 0.5)) + theme(legend.title = element_text(colour="black", size=15, face="bold")), break.time.by = 50, risk.table.y.text.col = T, risk.table.y.text = FALSE, title = (..(input$Tab5_KM_Clinical_Plot_Title)), 
                                   font.main = c(18, "plain", "black"), font.x = c(15, "plain", "black"), font.y = c(15, "plain", "black"), font.legend = c(14, "plain", "black"), font.tickslab = c(12, "plain", "black"))}) }}) 
    
    output$KM1 <- metaRender(renderPlot, {..(KMC1())})
    
    # Download Button
    output$Tab5_Download_KM_Clinical <- downloadHandler(filename = function(){paste("KM_Curve_Clin",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab5_KM_Clinical_Width, height = input$Tab5_KM_Clinical_Height)
        print(KMC1())
        dev.off()})
    
    # Logrank Output
    Logrank1 <- metaReactive2({if(is.null(Whole_Data()) | input$Tab5_KM_Clinical_Survival_Time  == "None Selected" | input$Tab5_KM_Clinical_Event_Status  == "None Selected" | input$Tab5_KM_Clinical_Select_Variable  == "None Selected"){return(NULL)}
        else{metaExpr({ survdiff(Surv(..(Whole_Data())[,..(input$Tab5_KM_Clinical_Survival_Time)], as.numeric(..(Whole_Data())[,..(input$Tab5_KM_Clinical_Event_Status)])) ~ ..(Whole_Data())[,..(input$Tab5_KM_Clinical_Select_Variable)])}) }})
    
    output$KMlogrank <- metaRender(renderPrint, { ..(Logrank1()) })
    
   # 2) Quartiles Survival Plot 2 -> Survival plot based on CNA score (Quartiles) 
   observe({vchoicesSurv2 <- c(names(Whole_Data()), "None Selected")
   updateSelectizeInput(session, "Tab5_KM_CNA_Survival_Time", choices = vchoicesSurv2, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab5_KM_CNA_Event_Status", choices = vchoicesSurv2, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab5_KM_CNA_Select_Variable", choices = vchoicesSurv2, selected = "None Selected", server = TRUE) })
   
   surv_data_1 <- metaReactive2({ metaExpr({
       data.frame(Time = ..(Whole_Data())[[..(input$Tab5_KM_CNA_Survival_Time)]], Strata = ..(Whole_Data())[[..(input$Tab5_KM_CNA_Select_Variable)]], cen  = ..(Whole_Data())[[..(input$Tab5_KM_CNA_Event_Status)]]) }) })
   
   SurvfitCNA <- metaReactive2({ metaExpr({survfit(Surv(as.numeric(Time), as.numeric(as.character(cen))) ~ Strata, data = ..(surv_data_1()))}) })
   
   PercentSurvPlot <- metaReactive2({
       if(is.null(Whole_Data()) | input$Tab5_KM_CNA_Survival_Time  == "None Selected" | input$Tab5_KM_CNA_Event_Status  == "None Selected" | input$Tab5_KM_CNA_Select_Variable  == "None Selected"){
           ggplot() + theme_void() }
       else{metaExpr({ggsurvplot(..(SurvfitCNA()), censor.shape="", xlab=..(input$Tab5_KM_CNA_X_Axis_Title), ylab=..(input$Tab5_KM_CNA_Y_Axis_Title), data = ..(surv_data_1()), size = 1, conf.int = ..(input$Tab5_KM_CNA_Display_CI), pval = ..(input$Tab5_KM_CNA_Display_Pval), risk.table = ..(input$Tab5_KM_CNA_Display_Risk_Table), 
                                 legend = c(..(input$Tab5_KM_CNA_Legend_Position)), legend.labs = rownames(summary(..(SurvfitCNA())$table)), risk.table.height = 0.25, pval.size = 6, ggtheme = theme_gray() + theme(plot.title = element_text(size= 18, hjust = 0.5)) + theme(legend.title = element_text(colour="black", size=15, face="bold")), break.time.by =50, risk.table.y.text.col = T, risk.table.y.text = FALSE, 
                                 legend.title = ..(input$Tab5_KM_CNA_Legend_Title), title = (..(input$Tab5_KM_CNA_Plot_Title)), font.main = c(18, "plain", "black"), font.x = c(15, "plain", "black"), font.y = c(15, "plain", "black"), font.legend = c(14, "plain", "black"), font.tickslab = c(12, "plain", "black"))}) } })
   
   output$PercentSurv <- metaRender(renderPlot, {..(PercentSurvPlot())})
   
   # Download Button
   output$Tab5_Download_KM_CNA <- downloadHandler(filename = function(){paste("KM_Curve_CNA",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab5_KM_CNA_Width, height = input$Tab5_KM_CNA_Height)
       print(PercentSurvPlot())
       dev.off()})
   
   Logrank2 <- metaReactive2({ if(is.null(Whole_Data()) | input$Tab5_KM_CNA_Survival_Time  == "None Selected" | input$Tab5_KM_CNA_Event_Status  == "None Selected" | input$Tab5_KM_CNA_Select_Variable  == "None Selected"){return(NULL)}
       else{metaExpr({ survdiff(Surv(..(Whole_Data())[,..(input$Tab5_KM_CNA_Survival_Time)], as.numeric(..(Whole_Data())[,..(input$Tab5_KM_CNA_Event_Status)])) ~ ..(Whole_Data())[,..(input$Tab5_KM_CNA_Select_Variable)])}) }})
   
   output$KMlogrank1 <- metaRender(renderPrint, { ..(Logrank2()) })
   
   # 3) Survival Curves - Treatment (Yes or No) 
   observe({vchoicesSurvsplit <- c(names(Whole_Data()), "None Selected")
   updateSelectizeInput(session, "Tab5_KM_Treatment_Survival_Time", choices = vchoicesSurvsplit, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab5_KM_Treatment_Event_Status", choices = vchoicesSurvsplit, selected = "None Selected", server = TRUE) 
   updateSelectizeInput(session, "Tab5_KM_Treatment_Select_Variable", choices = vchoicesSurvsplit, selected = "None Selected", server = TRUE) 
   updateSelectizeInput(session, "Tab5_KM_Treatment_Variable", choices = vchoicesSurvsplit, selected = "None Selected", server = TRUE)})
   
   dataRYes <- metaReactive2({ metaExpr({ ..(Whole_Data())[..(Whole_Data())[,..(input$Tab5_KM_Treatment_Variable)] == "YES",]}) })
   dataRNo <- metaReactive2({ metaExpr({ ..(Whole_Data())[..(Whole_Data())[,..(input$Tab5_KM_Treatment_Variable)] == "NO",]}) })
   
   surv_data_R <- metaReactive2({ metaExpr({
       data.frame(Time =  ..(dataRYes())[[..(input$Tab5_KM_Treatment_Survival_Time)]], Strata =  ..(dataRYes())[[..(input$Tab5_KM_Treatment_Select_Variable)]], Cen  =  ..(dataRYes())[[..(input$Tab5_KM_Treatment_Event_Status)]]) }) })
   
   datafit_R <- metaReactive2({ metaExpr({survfit(Surv(as.numeric(Time), as.numeric(as.character(Cen))) ~ Strata, data = ..(surv_data_R())) }) })
   
   KMR1Plot <- metaReactive2({
       if(is.null(Whole_Data()) | input$Tab5_KM_Treatment_Survival_Time  == "None Selected" | input$Tab5_KM_Treatment_Event_Status  == "None Selected" | input$Tab5_KM_Treatment_Select_Variable  == "None Selected" | input$Tab5_KM_Treatment_Variable == "None Selected"){
           ggplot() + theme_void() }
       else{ metaExpr({ggsurvplot(..(datafit_R()), censor.shape="", xlab= ..(input$Tab5_KM_Treatment_Yes_X_Axis_Title), ylab= ..(input$Tab5_KM_Treatment_Yes_Y_Axis_Title), data = ..(surv_data_R()), size = 1, conf.int = ..(input$Tab5_KM_Treatment_Yes_Display_CI), pval = ..(input$Tab5_KM_Treatment_Yes_Display_Pval), risk.table = ..(input$Tab5_KM_Treatment_Yes_Display_Risk_Table), 
                                  legend.title = ..(input$Tab5_KM_Treatment_Yes_Legend_Title), legend = c(..(input$Tab5_KM_Treatment_Yes_Legend_Position)), legend.labs = rownames(summary(..(datafit_R())$table)), pval.size = 6, risk.table.height = 0.25, ggtheme = theme_gray() + theme(plot.title = element_text(size= 18, hjust = 0.5)) + theme(legend.title = element_text(colour="black", size=15, face="bold")), break.time.by = 50, risk.table.y.text.col = T, risk.table.y.text = FALSE, 
                                  title = (..(input$Tab5_KM_Treatment_Yes_Title)), font.main = c(18, "plain", "black"), font.x = c(15, "plain", "black"), font.y = c(15, "plain", "black"), font.legend = c(14, "plain", "black"), font.tickslab = c(12, "plain", "black"))})}})
   
   output$KMR1 <- metaRender(renderPlot, { ..(KMR1Plot()) })
   
   # Download Button
   output$Tab5_Download_KM_Treatment_Yes <- downloadHandler(filename = function(){paste("KM_Survival_Treatment_Yes",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab5_KM_Treatment_Yes_Width, height = input$Tab5_KM_Treatment_Yes_Height)
       print(KMR1Plot())
       dev.off()})
   
   Logrank3 <- metaReactive2({ if(is.null(Whole_Data()) | input$Tab5_KM_Treatment_Survival_Time  == "None Selected" | input$Tab5_KM_Treatment_Event_Status  == "None Selected" | input$Tab5_KM_Treatment_Select_Variable  == "None Selected" | input$Tab5_KM_Treatment_Variable == "None Selected"){return(NULL)}
       else{metaExpr({ survdiff(Surv(..(dataRYes())[,..(input$Tab5_KM_Treatment_Survival_Time)], as.numeric(..(dataRYes())[,..(input$Tab5_KM_Treatment_Event_Status)])) ~ ..(dataRYes())[,..(input$Tab5_KM_Treatment_Select_Variable)])}) }})
   
   output$KMlogrankYes <- metaRender(renderPrint, { ..(Logrank3()) })
   
   Logrank4 <- metaReactive2({ if(is.null(Whole_Data()) | input$Tab5_KM_Treatment_Survival_Time  == "None Selected" | input$Tab5_KM_Treatment_Event_Status  == "None Selected" | input$Tab5_KM_Treatment_Select_Variable  == "None Selected" | input$Tab5_KM_Treatment_Variable == "None Selected"){return(NULL)}
       else{metaExpr({ survdiff(Surv(..(dataRNo())[,..(input$Tab5_KM_Treatment_Survival_Time)], as.numeric(..(dataRNo())[,..(input$Tab5_KM_Treatment_Event_Status)])) ~ ..(dataRNo())[,..(input$Tab5_KM_Treatment_Select_Variable)])}) }})
   
   output$KMlogrankNo <- metaRender(renderPrint, { ..(Logrank4()) })
   
   # KM Plot 2 (NO)
   surv_data_NR <- metaReactive2({ metaExpr({
       data.frame(Time = ..(dataRNo())[[..(input$Tab5_KM_Treatment_Survival_Time)]], Strata = ..(dataRNo())[[..(input$Tab5_KM_Treatment_Select_Variable)]], Cen  = ..(dataRNo())[[..(input$Tab5_KM_Treatment_Event_Status)]]) }) })
   
   datafit_NR <- metaReactive2({ metaExpr({survfit(Surv(as.numeric(Time), as.numeric(as.character(Cen))) ~ Strata, data = ..(surv_data_NR()))}) })
   
   KMR2Plot <- metaReactive2({ 
       if(is.null(Whole_Data()) | input$Tab5_KM_Treatment_Survival_Time  == "None Selected" | input$Tab5_KM_Treatment_Event_Status  == "None Selected" | input$Tab5_KM_Treatment_Select_Variable  == "None Selected" | input$Tab5_KM_Treatment_Variable == "None Selected"){
           ggplot() + theme_void() }
       else{
           metaExpr({ggsurvplot(..(datafit_NR()), censor.shape="", xlab=..(input$Tab5_KM_Treatment_No_X_Axis_Title), ylab=..(input$Tab5_KM_Treatment_No_Y_Axis_Title), data = ..(surv_data_NR()), size = 1, conf.int = ..(input$Tab5_KM_Treatment_No_Display_CI), pval = ..(input$Tab5_KM_Treatment_No_Display_Pval), risk.table = ..(input$Tab5_KM_Treatment_No_Display_Risk_Table), 
                                legend.title = ..(input$Tab5_KM_Treatment_No_Legend_Title), legend = c(..(input$Tab5_KM_Treatment_No_Legend_Position)), legend.labs = rownames(summary(..(datafit_NR())$table)), pval.size = 6, risk.table.height = 0.25, ggtheme = theme_gray() + theme(plot.title = element_text(size= 18, hjust = 0.5)) + theme(legend.title = element_text(colour="black", size=15, face="bold")), break.time.by = 50, risk.table.y.text.col = T, risk.table.y.text = FALSE, 
                                title = (..(input$Tab5_KM_Treatment_No_Title)), font.main = c(18, "plain", "black"), font.x = c(15, "plain", "black"), font.y = c(15, "plain", "black"), font.legend = c(14, "plain", "black"), font.tickslab = c(12, "plain", "black"))})}}) 
   
   output$KMR2 <-  metaRender(renderPlot, { ..(KMR2Plot()) })
   
   # Download Button
   output$Tab5_Download_KM_Treatment_No <- downloadHandler(filename = function(){paste("KM_Survival_Treatment_No",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab5_KM_Treatment_No_Width, height = input$Tab5_KM_Treatment_No_Height)
       print(KMR2())
       dev.off()})
   
   ## Tab 6 - Association Tests
   # Association analysis: Fishers exact test, chi-squared, ANOVA and KW
   
   # 1) Chi-Squared
   observe({vchoicesASS <- c(names(Whole_Data()), "None Selected")
   updateSelectizeInput(session, "Tab6_Select_Categorical_Variable_1", choices = vchoicesASS, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab6_Select_Categorical_Variable_2", choices = vchoicesASS, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab6_Select_Categorical_Variable_3", choices = vchoicesASS, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab6_Select_Continuous_Variable_1", choices = vchoicesASS, selected = "None Selected", server = TRUE)})
   
   # Create Table
   data_Association2 <- metaReactive2({
       metaExpr({ my_list <- list()
       for(i in 1:length(..(input$Tab6_Select_Categorical_Variable_2))){
           my_list[[i]] <- table(..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_1)], ..(Whole_Data())[, ..(input$Tab6_Select_Categorical_Variable_2)[i]])
       }
       my_list}) })
   
   # Print Each Chi-Squared Test
   Chi <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), paste("Please input clinical file, sample file and/or CNA file", "\n", "\n")))
       validate(need(!is.null(input$Tab6_Select_Categorical_Variable_2) | input$Tab6_Select_Categorical_Variable_2 == "None Selected" | input$Tab6_Select_Categorical_Variable_1 == "None Selected", paste("Please select categorical variables of interest", "\n", "\n")))
       if(input$Tab6_Select_Categorical_Variable_1 == "None Selected" || input$Tab6_Select_Categorical_Variable_2 == "None Selected"){return(NULL)}
       else{metaExpr({for(i in 1:length(c(..(input$Tab6_Select_Categorical_Variable_2)))){
           cat(noquote(paste("Categorical Variable 1:", ..(input$Tab6_Select_Categorical_Variable_1), "and", "Categorical Variable 2:", ..(input$Tab6_Select_Categorical_Variable_2)[i], "\n")))
           print(chisq.test(..(data_Association2())[[i]]))}})}
   })
   
   Chi_Code <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), paste("Please input clinical file, sample file and/or CNA file", "\n", "\n")))
       validate(need(!is.null(input$Tab6_Select_Categorical_Variable_2) | input$Tab6_Select_Categorical_Variable_2 == "None Selected" | input$Tab6_Select_Categorical_Variable_1 == "None Selected", paste("Please select categorical variables of interest", "\n", "\n")))
       if(input$Tab6_Select_Categorical_Variable_1 == "None Selected" || input$Tab6_Select_Categorical_Variable_2 == "None Selected"){return(NULL)}
       else{metaExpr({
           Chi_List <- list()
           for(i in 1:length(..(input$Tab6_Select_Categorical_Variable_2))){
               name <- ..(input$Tab6_Select_Categorical_Variable_2)[i]
               Chi_List[[name]] <- chisq.test(..(data_Association2())[[i]])}
           Chi_List})}
   })
   
   output$Cat1 <-  metaRender(renderPrint, { ..(Chi()) })
   
   data_Association1Ad <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Categorical_Variable_2) | input$Tab6_Select_Categorical_Variable_2 == "None Selected" | input$Tab6_Select_Categorical_Variable_1 == "None Selected", "Please select categorical variables of interest"))
       
       if(input$Tab6_Select_Categorical_Variable_1 == "None Selected" || input$Tab6_Select_Categorical_Variable_2 == "None Selected"){
           data.frame(Variables = character(10),
                                X = character(10),
                                df = character(10),
                                Pval = character(10),
                                Adj_Pval = character(10))}
       else{
           metaExpr({
               Variables <- Pval <- X <- df <- c()
               
               for(i in 1:length(..(input$Tab6_Select_Categorical_Variable_2))){
                   Variables <- c(Variables, paste(..(input$Tab6_Select_Categorical_Variable_1), "&", ..(input$Tab6_Select_Categorical_Variable_2)[i], sep=" "))
                   Test <- chisq.test(..(data_Association2())[[i]])
                   X <- c(X, round(as.numeric(Test$statistic), digits = 3))
                   df <- c(df, as.numeric(Test$parameter))
                   Pval <- c(Pval, signif(Test$p.value, digits=3)) 
               }
               Table <- cbind.data.frame(Variables, X, df, Pval) 
               Table$Adj_Pval <- signif(p.adjust(Table$Pval, method = "BH", n=length(..(input$Tab6_Select_Categorical_Variable_2))), digits=3)
               Table %>% select(Variables, X, df, Pval, Adj_Pval)})
       }})
   
   # Data Table with Adjusted P-values
   output$Cat1Ad <- metaRender(renderDataTable, {
       datatable(..(data_Association1Ad()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 10, scrollX = TRUE))})
   
   # 2) Fishers Exact Test
   # Simulated Fishers Test
   SimF <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), paste("Please input clinical file, sample file and/or CNA file", "\n", "\n")))
       validate(need(!is.null(input$Tab6_Select_Categorical_Variable_2), paste("Please select categorical variables of interest", "\n", "\n")))
       if(input$Tab6_Select_Categorical_Variable_1 == "None Selected" || input$Tab6_Select_Categorical_Variable_2 == "None Selected"){return(NULL)}
       else{metaExpr({for(i in 1:length(c(..(input$Tab6_Select_Categorical_Variable_2)))){
           cat(noquote(paste("Categorical Variable 1:", ..(input$Tab6_Select_Categorical_Variable_1), "and", "Categorical Variable 2:", ..(input$Tab6_Select_Categorical_Variable_2)[i], "\n")))
           print(fisher.test(..(data_Association2())[[i]], simulate.p.value = T))}})}
   })
   
   SimF_Code <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), paste("Please input clinical file, sample file and/or CNA file", "\n", "\n")))
       validate(need(!is.null(input$Tab6_Select_Categorical_Variable_2), paste("Please select categorical variables of interest", "\n", "\n")))
       if(input$Tab6_Select_Categorical_Variable_1 == "None Selected" || input$Tab6_Select_Categorical_Variable_2 == "None Selected"){return(NULL)}
       else{metaExpr({
           SimF_List <- list()
           for(i in 1:length(..(input$Tab6_Select_Categorical_Variable_2))){
               name <- ..(input$Tab6_Select_Categorical_Variable_2)[i]
               SimF_List[[name]] <- fisher.test(..(data_Association2())[[i]], simulate.p.value = T)}
           SimF_List})}})
   
   output$Cat2 <-  metaRender(renderPrint, { ..(SimF()) })
   
   data_Association2Ad <-  metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Categorical_Variable_2), "Please select categorical variables of interest"))
       
       if(input$Tab6_Select_Categorical_Variable_1 == "None Selected" || input$Tab6_Select_Categorical_Variable_2 == "None Selected"){ 
           data.frame(Variables = character(10),
                                Pval = character(10),
                                Adj_Pval = character(10))}
       else{
           metaExpr({ 
               Variables <- Pval <- c()
               
               for(i in 1:length(..(input$Tab6_Select_Categorical_Variable_2))){
                   Variables <- c(Variables, paste(..(input$Tab6_Select_Categorical_Variable_1), "&", ..(input$Tab6_Select_Categorical_Variable_2)[i], sep=" "))
                   Test <- fisher.test(..(data_Association2())[[i]], simulate.p.value = T)
                   Pval <- c(Pval, signif(Test$p.value, digits=3))
               }
               
               Table <- cbind.data.frame(Variables, Pval) 
               Table$Adj_Pval <- signif(p.adjust(Table$Pval, method = "BH", n=length(..(input$Tab6_Select_Categorical_Variable_2))), digits=3)
               Table %>% select(Variables, Pval, Adj_Pval)})}
   })
   
   output$Cat2Ad <- metaRender(renderDataTable, {
       DT::datatable(..(data_Association2Ad()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 10, scrollX = TRUE))})
   
   # Fishers Exact Test
   Fis <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), paste("Please input clinical file, sample file and/or CNA file", "\n", "\n")))
       validate(need(!is.null(input$Tab6_Select_Categorical_Variable_2), paste("Please select categorical variables of interest", "\n", "\n")))
       if(input$Tab6_Select_Categorical_Variable_1 == "None Selected" || input$Tab6_Select_Categorical_Variable_2 == "None Selected"){return(NULL)}
       else{metaExpr({ for(i in 1:length(c(..(input$Tab6_Select_Categorical_Variable_2)))){
           tryCatch({
               cat(noquote(paste("Categorical Variable 1:", ..(input$Tab6_Select_Categorical_Variable_1), "and", "Categorical Variable 2:", ..(input$Tab6_Select_Categorical_Variable_2)[i], "\n")))
               print(fisher.test(..(data_Association2())[[i]], simulate.p.value = F))
               # continue if error
           }, error=function(e){cat("ERROR :",conditionMessage(e), "\n")})}})}
   })
   
   F_Code <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), paste("Please input clinical file, sample file and/or CNA file", "\n", "\n")))
       validate(need(!is.null(input$Tab6_Select_Categorical_Variable_2), paste("Please select categorical variables of interest", "\n", "\n")))
       if(input$Tab6_Select_Categorical_Variable_1 == "None Selected" || input$Tab6_Select_Categorical_Variable_2 == "None Selected"){return(NULL)}
       else{metaExpr({
           F_List <- list()
           for(i in 1:length(..(input$Tab6_Select_Categorical_Variable_2))){
               name <- ..(input$Tab6_Select_Categorical_Variable_2)[i]
               tryCatch({
                   F_List[[name]] <- fisher.test(..(data_Association2())[[i]], simulate.p.value = F)
                   # continue if error
               }, error=function(e){cat("ERROR :",conditionMessage(e), "\n")})}
       F_List})}})
   
   output$Cat3 <-  metaRender(renderPrint, { ..(Fis()) })
   
   data_Association3Ad <- metaReactive2({
       if(input$Tab6_Select_Categorical_Variable_1 == "None Selected" || input$Tab6_Select_Categorical_Variable_2 == "None Selected"){
           data.frame(Variables = character(10),
                                Pval = character(10),
                                Adj_Pval = character(10))
       }
       else{
           metaExpr({
               Variables <- Pval <- c()
               
               for(i in 1:length(..(input$Tab6_Select_Categorical_Variable_2))){
                   tryCatch({
                       Test <- fisher.test(..(data_Association2())[[i]])
                       Pval <- c(Pval, signif(Test$p.value, digits=3))
                       Variables <- c(Variables, paste(..(input$Tab6_Select_Categorical_Variable_1), "&", ..(input$Tab6_Select_Categorical_Variable_2)[i], sep=" "))
                       # continue if error
                   }, error=function(e){cat("ERROR :",conditionMessage(e), "\n")})
               }
               Table <- cbind.data.frame(Variables, Pval) 
               Table$Adj_Pval <- signif(p.adjust(Table$Pval, method = "BH", n=length(..(input$Tab6_Select_Categorical_Variable_2))), digits=3)
               Table %>% select(Variables, Pval, Adj_Pval) })
       }})
   
   output$Cat3Ad <- metaRender(renderDataTable, {
       DT::datatable(..(data_Association3Ad()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 10, scrollX = TRUE))})
   
   # ANOVA Assumptions
   # 1
   Assump1 <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
           cat(noquote(paste("Categorical Variable:", ..(input$Tab6_Select_Categorical_Variable_3), "and", "Continuous Variable:", ..(input$Tab6_Select_Continuous_Variable_1)[i], "\n", "\n")))
           print(leveneTest(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]] ~ ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], ..(Whole_Data()), center=mean)) }})}})
   
   Levene_Code <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), paste("Please input clinical file, sample file and/or CNA file", "\n", "\n")))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({
           Levene_List <- list()
           for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
               name <- ..(input$Tab6_Select_Continuous_Variable_1)[i]
               Levene_List[[name]] <- leveneTest(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]] ~ ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], ..(Whole_Data()), center=mean)
           Levene_List}})}})
   
   output$ANOVAAss1  <-  metaRender(renderPrint, { ..(Assump1()) })
   
   Assump2 <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({ for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
           cat(noquote(paste("Categorical Variable:", ..(input$Tab6_Select_Categorical_Variable_3), "and", "Continuous Variable:", ..(input$Tab6_Select_Continuous_Variable_1)[i], "\n")))
           print(fligner.test(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]] ~ ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], ..(Whole_Data())))}})} })
   
   Fligner_Code <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), paste("Please input clinical file, sample file and/or CNA file", "\n", "\n")))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({
           Fligner_List <- list()
           for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
               name <- ..(input$Tab6_Select_Continuous_Variable_1)[i]
               Fligner_List[[name]] <- fligner.test(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]] ~ ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], ..(Whole_Data()))
               Fligner_List}})}})
   
   output$ANOVAAss2  <-  metaRender(renderPrint, { ..(Assump2()) })
   
   Assump3 <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" || input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{
           metaExpr({for(i in 1:length(c(..(input$Tab6_Select_Continuous_Variable_1)))){
                   cat(noquote(paste("Categorical Variable:", ..(input$Tab6_Select_Categorical_Variable_3), "and", "Continuous Variable:", ..(input$Tab6_Select_Continuous_Variable_1)[i], "\n", "\n")))
                   Data1 <- ..(Whole_Data()) %>% group_by(!!as.name(..(input$Tab6_Select_Categorical_Variable_3))) %>% shapiro_test(!!as.name(..(input$Tab6_Select_Continuous_Variable_1)[i]))
                   print(as.data.frame(Data1))
                   print(shapiro.test(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]])) }})}}) # It tests the null hypothesis that the population variances are equal
   
   Shapiro_Code <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), paste("Please input clinical file, sample file and/or CNA file", "\n", "\n")))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({
           Shapiro_List <- list()
           for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
               name <- ..(input$Tab6_Select_Continuous_Variable_1)[i]
               Shapiro_List[[name]] <- shapiro.test(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]])
               Shapiro_List}})}})
   
   output$ANOVAAss3 <-  metaRender(renderPrint, { ..(Assump3()) })
   
   # ANOVA 
   ANOVA_R <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{ metaExpr({ for(i in 1:length(c(..(input$Tab6_Select_Continuous_Variable_1)))){
           res.aov <- aov(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]] ~ ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], data = ..(Whole_Data()))
           cat(noquote(paste("Categorical Variable:", ..(input$Tab6_Select_Categorical_Variable_3), "and", "Continuous Variable:", ..(input$Tab6_Select_Continuous_Variable_1)[i], "\n", "\n")))
           print(summary(res.aov))}})}})
   
   ANOVA_Code <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), paste("Please input clinical file, sample file and/or CNA file", "\n", "\n")))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({
           ANOVA_List <- list()
           for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
               name <- ..(input$Tab6_Select_Continuous_Variable_1)[i]
               ANOVA_List[[name]] <-  summary(aov(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]] ~ ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], data = ..(Whole_Data())))
               ANOVA_List}})}})
   
   output$ANOVA <-  metaRender(renderPrint, { ..(ANOVA_R()) })
   
   data_ANOVAAd <-metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1== "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){
           data.frame(Variables = character(10),
                                X = character(10),
                                df = character(10),
                                Pval = character(10),
                                Adj_Pval = character(10))
       }
       else{
           metaExpr({
               Variables <- Pval <- c()
               
               for(i in 1:length(c(..(input$Tab6_Select_Continuous_Variable_1)))){
                   Variables <- c(Variables, paste(..(input$Tab6_Select_Categorical_Variable_3), "&", ..(input$Tab6_Select_Continuous_Variable_1)[i], sep=" "))
                   Test <- summary(aov(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]] ~ ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], data = ..(Whole_Data())))
                   Pval <- c(Pval, signif(as.numeric(Test[[1]]$`Pr(>F)`[1]), digits=3))
                  
               }
               Table <- cbind.data.frame(Variables, Pval) 
               Table$Adj_Pval <- signif(p.adjust(Table$Pval, method = "BH", n=length(..(input$Tab6_Select_Continuous_Variable_1))), digits=3)
               Table %>% select(Variables, Pval, Adj_Pval)})}
   })
   
   output$ANOVAAd <- metaRender(renderDataTable, {
       DT::datatable(..(data_ANOVAAd()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 10, scrollX = TRUE))})
   
   # Kruskal Wallis
   KW_R <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({ for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
           Kw <- kruskal.test(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]] ~ ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], data = ..(Whole_Data()))
           cat(noquote(paste("Categorical Variable:", ..(input$Tab6_Select_Categorical_Variable_3), "and", "Continuous Variable:", ..(input$Tab6_Select_Continuous_Variable_1)[i], "\n")))
           print(Kw)}})}
   })
   
   KW_Code <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({ 
           KW_List <- list()
           for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
               name <- ..(input$Tab6_Select_Continuous_Variable_1)[i]
               KW_List[[name]] <- kruskal.test(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]] ~ ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], data = ..(Whole_Data()))
           }
           KW_List})}})
   
   output$KW <-  metaRender(renderPrint, { ..(KW_R()) })
   
   # Adj
   data_KWAdj <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1== "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){
           data.frame(Variables = character(10),
                                Statistic = character(10),
                                df = character(10),
                                Pval = character(10),
                                Adj_Pval = character(10))
       } else {
           metaExpr({
               Variables <- Statistic <- df <- Pval <- c()
               
               for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
                   Variables <- c(Variables, paste(..(input$Tab6_Select_Categorical_Variable_3), "&", ..(input$Tab6_Select_Continuous_Variable_1)[i], sep=" "))
                   Test <- kruskal.test(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]] ~ ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], data = ..(Whole_Data()))
                   Statistic <- c(Statistic, signif(Test$statistic[[1]], digits = 3))
                   df <- c(df, Test$parameter[[1]])
                   Pval <- c(Pval, signif(as.numeric(Test$p.value[[1]]), digits=3))
               }
               
               Table <- cbind.data.frame(Variables, Statistic, df, Pval) 
               Table$Adj_Pval <- signif(p.adjust(Table$Pval, method = "BH", n=length(..(input$Tab6_Select_Continuous_Variable_1))), digits=3)
               Table %>% select(Variables, Statistic, df, Pval, Adj_Pval)
               })}
   })
   
   output$KWAd <- metaRender(renderDataTable, {
       DT::datatable(..(data_KWAdj()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 10, scrollX = TRUE))})
   
   PWC <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       validate(need(input$Tab6_Select_Continuous_Variable_1 != "None Selected" & input$Tab6_Select_Categorical_Variable_3 != "None Selected", "Please select variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({ for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
           cat(noquote(paste("Categorical Variable:", ..(input$Tab6_Select_Categorical_Variable_3), "and", "Continuous Variable:", ..(input$Tab6_Select_Continuous_Variable_1)[i], "\n", "\n")))
           print(pairwise.t.test(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]], ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], p.adjust.method = "BH")) }})}
   })
   
  PWT_Code <- metaReactive2({
      validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
      validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
      validate(need(input$Tab6_Select_Continuous_Variable_1 != "None Selected" & input$Tab6_Select_Categorical_Variable_3 != "None Selected", "Please select variables of interest"))
      if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
      else{metaExpr({ 
          PairwiseT_List <- list()
          for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
              name <- ..(input$Tab6_Select_Continuous_Variable_1)[i]
              PairwiseT_List[[name]] <- pairwise.t.test(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]], ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], p.adjust.method = "BH")
          }
          PairwiseT_List})}})
   
   output$PC <-  metaRender(renderPrint, { ..(PWC()) })
   
   PWCDunn <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       validate(need(input$Tab6_Select_Continuous_Variable_1 != "None Selected" & input$Tab6_Select_Categorical_Variable_3 != "None Selected", "Please select variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({ for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
           cat(noquote(paste("Categorical Variable:", ..(input$Tab6_Select_Categorical_Variable_3), "and", "Continuous Variable:", ..(input$Tab6_Select_Continuous_Variable_1)[i], "\n")))
           print(DunnTest(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]], ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], method = "BH", out.list = F)) }})}
   })
   
   PWD_Code <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab6_Select_Continuous_Variable_1), "Please select continuous variables of interest"))
       validate(need(input$Tab6_Select_Continuous_Variable_1 != "None Selected" & input$Tab6_Select_Categorical_Variable_3 != "None Selected", "Please select variables of interest"))
       if(input$Tab6_Select_Continuous_Variable_1 == "None Selected" | input$Tab6_Select_Categorical_Variable_3 == "None Selected"){return(NULL)}
       else{metaExpr({ 
           PairwiseD_List <- list()
           for(i in 1:length(..(input$Tab6_Select_Continuous_Variable_1))){
               name <- ..(input$Tab6_Select_Continuous_Variable_1)[i]
               PairwiseD_List[[name]] <- DunnTest(..(Whole_Data())[,..(input$Tab6_Select_Continuous_Variable_1)[i]], ..(Whole_Data())[,..(input$Tab6_Select_Categorical_Variable_3)], method = "BH", out.list = F)
           }
           PairwiseD_List})}})
   
   output$Dunn <- metaRender(renderPrint, { ..(PWCDunn()) })
   
   ## Tab 7 - Cox Models
   # Univariate Cox Models 
   # Inputs
   observe({ vchoicesSurvcox <- c(names(Whole_Data()), "None Selected")
   updateSelectizeInput(session, "Tab7_Univariate_Cox_Survival_Time", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab7_Univariate_Cox_Event_Status", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab7_Univariate_Cox_Select_Variables", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab7_Multivariable_Cox_Survival_Time", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab7_Multivariable_Cox_Event_Status", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab7_Multivariable_Cox_Select_Variables", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab7_Multivariable_Cox_Select_Interaction_Variables_1", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab7_Multivariable_Cox_Select_Interaction_Variables_2", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab7_Multivariable_Cox_Select_Interaction_Variables_3", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)})
   
   # Uni Model 
   surv_data_Cox <- metaReactive2({metaExpr({..(Whole_Data()) %>% select(!!..(input$Tab7_Univariate_Cox_Survival_Time), !!..(input$Tab7_Univariate_Cox_Event_Status), c(!!..(input$Tab7_Univariate_Cox_Select_Variables)))}) })
   
   CoxModelOut_1 <-  metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "\n \n \n \n Please input clinical file, sample file and/or CNA file \n \n \n \n \n"))
       validate(need(!is.null(input$Tab7_Univariate_Cox_Select_Variables), "\n \n \n \n Please select time to event, event status and variable of interest \n \n \n \n \n"))
       
       if(is.null(Whole_Data()) | input$Tab7_Univariate_Cox_Survival_Time == "None Selected" | input$Tab7_Univariate_Cox_Event_Status  == "None Selected" | input$Tab7_Univariate_Cox_Select_Variables == "None Selected"){
           return(NULL)}
       else{ 
           metaExpr({for(i in 1:length(..(input$Tab7_Univariate_Cox_Select_Variables))){
               cat(noquote(paste(..(input$Tab7_Univariate_Cox_Event_Status), "for", ..(input$Tab7_Univariate_Cox_Select_Variables)[i], "\n", "\n")))
               res.cox <- coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Univariate_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Univariate_Cox_Event_Status),"))) ~", noquote(paste(..(input$Tab7_Univariate_Cox_Select_Variables)[i], collapse="+")))), data = ..(surv_data_Cox()))
               print(summary(res.cox))}})
       }})
   
   output$CoxModelOut <- metaRender(renderPrint, { ..(CoxModelOut_1()) })
   
   # Uni Models Adj
   data_UniAdj <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "\n \n Please input clinical file, sample file and/or CNA file \n \n"))
       validate(need(!is.null(input$Tab7_Univariate_Cox_Select_Variables), "\n \n Please select time to event, event status and variable of interest \n \n"))
       if(is.null(Whole_Data()) | input$Tab7_Univariate_Cox_Survival_Time == "None Selected" | input$Tab7_Univariate_Cox_Event_Status  == "None Selected" | input$Tab7_Univariate_Cox_Select_Variables == "None Selected"){
           data.frame(Variables = character(10),
                                LRT = character(10),
                                Adj_LRT = character(10),
                                Wald = character(10),
                                Adj_Wald = character(10),
                                Logrank = character(10),
                                Adj_Logrank = character(10)) }
       else{
           metaExpr({
               Variables <- LRT <- Wald <- Logrank <- c()
               
               for(i in 1:length(..(input$Tab7_Univariate_Cox_Select_Variables))){
                   Variables <- c(Variables, paste(..(input$Tab7_Univariate_Cox_Event_Status), "for", ..(input$Tab7_Univariate_Cox_Select_Variables)[i], sep=" "))
                   res.cox <- coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Univariate_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Univariate_Cox_Event_Status),"))) ~", noquote(paste(..(input$Tab7_Univariate_Cox_Select_Variables)[i], collapse="+")))), data = ..(surv_data_Cox()))
                   LRT <- c(LRT, signif(as.numeric(summary(res.cox)$logtest[3]), digits=3))
                   Wald <- c(Wald, signif(as.numeric(summary(res.cox)$waldtest[3]), digits=3))
                   Logrank <- c(Logrank, signif(as.numeric(summary(res.cox)$sctest[3]), digits=3))
               }
               
               Table <- cbind.data.frame(Variables, LRT, Wald, Logrank)
               Table$Adj_LRT <- signif(p.adjust(as.numeric(Table$LRT), method = "BH", n=length(..(input$Tab7_Univariate_Cox_Select_Variables))), digits=3)
               Table$Adj_Wald <- signif(p.adjust(as.numeric(Table$Wald), method = "BH", n=length(..(input$Tab7_Univariate_Cox_Select_Variables))), digits=3)
               Table$Adj_Logrank <- signif(p.adjust(as.numeric(Table$Logrank), method = "BH", n=length(..(input$Tab7_Univariate_Cox_Select_Variables))), digits=3)
               Table %>% select(Variables, LRT, Adj_LRT, Wald, Adj_Wald, Logrank, Adj_Logrank)})}
   })
   
   output$UniAdjusted <- metaRender(renderDataTable, {
       DT::datatable(..(data_UniAdj()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 10, scrollX = TRUE))})
   
   # Multi Model 
   surv_data_CoxM <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "\n \n Please input clinical file, sample file and/or CNA file \n \n \n"))
       validate(need(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), "\n \n Please make sure all select boxes are filled \n \n \n"))
       
       # 1st
       if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Variables)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Variables)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1)))})}
       
       # 2nd 
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Variables)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Variables)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2)))})}
       
       #3 
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Variables)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Variables)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Variables)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Variables)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3)))})}
       else if(input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" & input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" & input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({..(Whole_Data())%>% select(!!..(input$Tab7_Multivariable_Cox_Survival_Time), !!..(input$Tab7_Multivariable_Cox_Event_Status), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2)), c(!!..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3)))})}
       else{return(NULL)}})
   
   
   CoxModel <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "\n \n Please input clinical file, sample file and/or CNA file \n \n \n"))
       validate(need(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), "\n \n Please make sure all select boxes are filled \n \n \n"))
       if(is.null(Whole_Data()) | input$Tab7_Multivariable_Cox_Survival_Time == "None Selected" | input$Tab7_Multivariable_Cox_Event_Status  == "None Selected"){
          return(NULL) }
       # 1
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({summary( coxph(formula = as.formula(paste("Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep="")))), data = ..(surv_data_CoxM())))})}
       # 2 
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste("Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""),  "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""),  "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep="")))), data = ..(surv_data_CoxM())))})}
       
       # 3 
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({summary( coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({summary(coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM())))})}
       else{return(NULL)}})
   
   output$CoxModelMultiOut <- metaRender(renderPrint, { ..(CoxModel()) })
   output$Waldtestid <- metaRender(renderPrint, { ..(CoxModel())$waldtest })
   output$LRTid <-  metaRender(renderPrint, { ..(CoxModel())$logtest })
   output$Logrid <- metaRender(renderPrint, { ..(CoxModel())$sctest })
   
   # Cox Models Assumptions
   CoxAssump  <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "\n \n Please input clinical file, sample file and/or CNA file \n \n \n"))
       validate(need(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), "\n \n Please make sure all select boxes are filled \n \n \n"))
       if(is.null(Whole_Data()) | input$Tab7_Multivariable_Cox_Survival_Time == "None Selected" | input$Tab7_Multivariable_Cox_Event_Status  == "None Selected"){
           return(NULL) }
       # 1
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({coxph(formula = as.formula(paste("Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep="")))), data = ..(surv_data_CoxM()))})}
       # 2 
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({coxph(formula = as.formula(paste("Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""),  "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""),  "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 == "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep="")))), data = ..(surv_data_CoxM()))})}
       
       # 3 
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables == "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else if(input$Tab7_Multivariable_Cox_Select_Variables != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2 != "None Selected" & input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3 != "None Selected"){
           metaExpr({coxph(formula = as.formula(paste( "Surv(as.numeric(",..(input$Tab7_Multivariable_Cox_Survival_Time),"), as.numeric(as.character(",..(input$Tab7_Multivariable_Cox_Event_Status),"))) ~", noquote(paste(paste(..(input$Tab7_Multivariable_Cox_Select_Variables), collapse="+"), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2), collapse="+"), ")^2", sep=""), "+", paste("(", paste(..(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3), collapse="+"), ")^3", sep=""), sep="")))), data = ..(surv_data_CoxM()))})}
       else{return(NULL)}})
   
   Assump <- metaReactive2({
       if(is.null(Whole_Data()) | input$Tab7_Multivariable_Cox_Survival_Time == "None Selected" | input$Tab7_Multivariable_Cox_Event_Status  == "None Selected" | input$Tab7_Multivariable_Cox_Select_Variables == "None Selected"){ggplot() + theme_void()}
       else{metaExpr({ggcoxzph(cox.zph(..(CoxAssump()), terms = ..(input$Tab7_Cox_Assumptions_Display_by_Variable)))})} })

   output$AssumptionsCox = metaRender(renderPlot, { ..(Assump()) })
   
   # Download
   output$Tab7_Download_Cox_Assumptions_Plot <- downloadHandler(filename = function(){paste("Cox_Assumptions",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab7_Cox_Assumptions_Plot_Width, height = input$Tab7_Cox_Assumptions_Plot_Height)
       print(ggcoxzph(Assump()))
       dev.off()})
   
   ## Tab 8 - Adjusted Survival Curves 
   observe({vchoicesSurvcox <- c(names(Whole_Data()), "None Selected")
   updateSelectizeInput(session, "Tab8_Adjusted_Curves_Select_Constant_Variable", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab8_Adjusted_Curves_Select_Variable_1", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab8_Adjusted_Curves_Select_Variable_2", choices = vchoicesSurvcox, selected = "None Selected", server = TRUE)})
   
   # Multivariable Cox Model (from previous Tab)
   output$Interaction <- metaRender(renderPrint, { ..(CoxAssump()) })
   
   # New Data Table 
   NewData <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) & !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) & !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable), "Please make sure all select boxes are filled"))
       
       if(is.null(Whole_Data()) | input$Tab8_Adjusted_Curves_Select_Variable_1  == "None Selected" | input$Tab8_Adjusted_Curves_Select_Variable_2 == "None Selected"){
           data.frame(Variable_1 = character(), Variable_2 = character(), Variable_3 = character()) }
       else if(input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" & input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" & input$Tab8_Adjusted_Curves_Select_Constant_Variable == "None Selected") {
           metaExpr({ 
               
               Levels_Vector_1 <- Levels_Rep <- c()
           
           for(n_levels_1 in 1:length(levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_2)])))){
               Levels_Vector_1 <- c(Levels_Vector_1, c(rep(levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_2)]))[n_levels_1], length(levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_1)]))))))} 
           
           for(n_levels_2 in 1:length(levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_1)])))){
               Levels_Rep <- c(Levels_Rep, levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_1)]))[n_levels_2])}
           
           Levels_Vector_2 <- c(rep(Levels_Rep, length(levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_2)])))))
           
           Lev <- data.frame("Row" = 1:length(Levels_Vector_2)) %>% mutate(!!..(input$Tab8_Adjusted_Curves_Select_Variable_1) := Levels_Vector_2, !!..(input$Tab8_Adjusted_Curves_Select_Variable_2) := Levels_Vector_1) %>% select(!!..(input$Tab8_Adjusted_Curves_Select_Variable_1), !!..(input$Tab8_Adjusted_Curves_Select_Variable_2))
           Lev})}
       else {
           metaExpr({ Levels_Vector_1 <- Levels_Rep <- c()
           
           for(n_levels_1 in 1:length(levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_2)])))){
               Levels_Vector_1 <- c(Levels_Vector_1, c(rep(levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_2)]))[n_levels_1], length(levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_1)]))))))} 
           
           for(n_levels_2 in 1:length(levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_1)])))){
               Levels_Rep <- c(Levels_Rep, levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_1)]))[n_levels_2])}
           
           Levels_Vector_2 <- c(rep(Levels_Rep, length(levels(as.factor(..(Whole_Data())[,..(input$Tab8_Adjusted_Curves_Select_Variable_2)])))))
           
           Lev <- data.frame("Row" = 1:length(Levels_Vector_2)) %>% mutate(!!..(input$Tab8_Adjusted_Curves_Select_Variable_1) := Levels_Vector_2, !!..(input$Tab8_Adjusted_Curves_Select_Variable_2) := Levels_Vector_1) %>% select(!!..(input$Tab8_Adjusted_Curves_Select_Variable_1), !!..(input$Tab8_Adjusted_Curves_Select_Variable_2))
           
           for(constant_var in 1:length(..(input$Tab8_Adjusted_Curves_Select_Constant_Variable))){
               varname <- ..(input$Tab8_Adjusted_Curves_Select_Constant_Variable)[constant_var]
               if(is.factor(..(Whole_Data())[,varname])){
                   Lev[,c(varname)] <- getmode(..(Whole_Data())[,varname])
               } else {
                   Lev <- mutate(Lev,  !!varname :=  mean(..(Whole_Data())[,varname], na.rm=T))
                    } 
           }
           Lev }) }
   })
   
   
   output$preddata <- metaRender(renderDataTable, {
       DT::datatable(..(NewData()), options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "270px"))})
   
   # All Data Adjusted Survival Curves 
   fit_All <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) & !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) & !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable), "Please make sure all select boxes are filled"))
      
       if(is.null(Whole_Data()) | input$Tab8_Adjusted_Curves_Select_Variable_1 == "None Selected" | input$Tab8_Adjusted_Curves_Select_Variable_2 == "None Selected"){ggplot() + theme_void() }
       else{
           metaExpr({ dat <- ..(NewData())
           rownames(dat) <- do.call(paste,c(dat[c(..(input$Tab8_Adjusted_Curves_Select_Variable_1), ..(input$Tab8_Adjusted_Curves_Select_Variable_2))], sep="_"))
           fit <- survfit(..(CoxAssump()), newdata = dat)
           survminer::ggsurvplot(fit, data = ..(NewData()), censor.shape="", xlab=..(input$Tab8_Adjusted_Curves_X_Axis_Title), ylab=..(input$Tab8_Adjusted_Curves_Y_Axis_Title), size = 1, conf.int = ..(input$Tab8_Adjusted_Curves_Display_CI), risk.table = ..(input$Tab8_Adjusted_Curves_Display_Risk_Table), 
                                            legend = c(..(input$Tab8_Adjusted_Curves_Legend_Position)), legend.labs = rownames(summary(fit$table)), risk.table.height = 0.25, pval.size = 6, ggtheme = theme_gray() + theme(plot.title = element_text(size= 18, hjust = 0.5)) + theme(legend.title = element_text(colour="black", size=15, face="bold")), break.time.by =50, risk.table.y.text.col = T, risk.table.y.text = FALSE, 
                                            legend.title = ..(input$Tab8_Adjusted_Curves_Legend_Title), title = (..(input$Tab8_Adjusted_Curves_Plot_Title)), font.main = c(18, "plain", "black"), font.x = c(15, "plain", "black"), font.y = c(15, "plain", "black"), font.legend = c(14, "plain", "black"), font.tickslab = c(12, "plain", "black"))})} })
   
   
   output$Pred1 = metaRender(renderPlot, { ..(fit_All()) })
   
   # Adjusted Curves by Level
   All_fits <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) & !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) & !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable), "Please make sure all select boxes are filled"))
     
       metaExpr({ Data <- ..(NewData())
       level_choice <- levels(as.factor(Data[,..(input$Tab8_Adjusted_Curves_Select_Variable_1)]))
       Fit_List <- list() 
       Surv_List <- list()
       rownames(Data) <- do.call(paste,c(Data[c(..(input$Tab8_Adjusted_Curves_Select_Variable_1), ..(input$Tab8_Adjusted_Curves_Select_Variable_2))], sep="_"))
       
       for(i in 1:length(level_choice)){
           Data1 <-  Data[Data[,c(..(input$Tab8_Adjusted_Curves_Select_Variable_1))] %in% level_choice[i],]
           fit <- survfit(..(CoxAssump()), newdata = Data1)
           Fit_List[[i]] <- fit
       }
       
       for(j in 1:length(Fit_List)){
           plot1 <- survminer::ggsurvplot(Fit_List[[j]], data = Data, censor.shape="", xlab=..(input$Tab8_Adjusted_Curves_X_Axis_Title), ylab=..(input$Tab8_Adjusted_Curves_Y_Axis_Title), size = 1, conf.int = ..(input$Tab8_Adjusted_Curves_Display_CI), risk.table = ..(input$Tab8_Adjusted_Curves_Display_Risk_Table), 
                                          legend = c(..(input$Tab8_Adjusted_Curves_Legend_Position)), legend.labs = rownames(summary(Fit_List[[j]]$table)), risk.table.height = 0.25, pval.size = 6, ggtheme = theme_gray() + theme(plot.title = element_text(size= 18, hjust = 0.5)) + theme(legend.title = element_text(colour="black", size=15, face="bold")), break.time.by =50, risk.table.y.text.col = T, risk.table.y.text = FALSE, 
                                          legend.title = ..(input$Tab8_Adjusted_Curves_Legend_Title), title = (..(input$Tab8_Adjusted_Curves_Plot_Title)), font.main = c(18, "plain", "black"), font.x = c(15, "plain", "black"), font.y = c(15, "plain", "black"), font.legend = c(14, "plain", "black"), font.tickslab = c(12, "plain", "black"))
           Surv_List[[j]] <- plot1
       }
       return(Surv_List)})
   })
   
   
   output$Pred2 <- renderUI({ 
       if(is.null(Whole_Data()) | input$Tab8_Adjusted_Curves_Select_Variable_1 == "None Selected" | input$Tab8_Adjusted_Curves_Select_Variable_2 == "None Selected"){return(NULL)}
       else{ 
           plot_output_list_Whole <- lapply(1:length(All_fits()), function(i) {
               plotnameWhole <- paste("plotwhole", i, sep="")
               output[[plotnameWhole]] <- renderPlot({All_fits()[[i]]})
               plotOutput(plotnameWhole, width = "100%", height = "400px")
           })
           do.call(tagList, plot_output_list_Whole) }
   })
   
   
   # Download Plots (Option for all plots)
   outVar = metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) & !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) & !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable), "Please make sure all select boxes are filled"))
       if(input$Tab8_Adjusted_Curves_Select_Variable_1 == "None Selected" | is.null(input$Tab8_Adjusted_Curves_Select_Variable_1)){
           metaExpr({ Dat <- c("None Selected")})
       } else {
           metaExpr({ Data <- ..(Whole_Data())
           mydata = ..(input$Tab8_Adjusted_Curves_Select_Variable_1)
           lev <- c(levels(as.factor(Data[,c(mydata)])), "None Selected")} )}
   })
   
   observe({Adjchoice <- c("All Levels", outVar())
   updateSelectInput(session, "Tab8_Download_Adjusted_Curves_Select", choices = Adjchoice, selected = "None Selected")})
   
   OutVarPlot <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) & !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) & !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable), "Please make sure all select boxes are filled"))

       if(input$Tab8_Download_Adjusted_Curves_Select == "All Levels"){
           metaExpr({ Data <- ..(NewData())
           rownames(Data) <- do.call(paste,c(Data[c(..(input$Tab8_Adjusted_Curves_Select_Variable_1), ..(input$Tab8_Adjusted_Curves_Select_Variable_2))], sep="_"))
           fit <- survfit(..(CoxAssump()), newdata = Data)
           survminer::ggsurvplot(fit, data = Data, censor.shape="", xlab=..(input$Tab8_Download_Adjusted_Curves_X_Axis_Title), ylab=..(input$Tab8_Download_Adjusted_Curves_Y_Axis_Title), size = 1, conf.int = ..(input$Tab8_Download_Adjusted_Curves_Display_CI), risk.table = ..(input$Tab8_Download_Adjusted_Curves_Display_Risk_Table), 
                                          legend = c(..(input$Tab8_Download_Adjusted_Curves_Legend_Position)), legend.labs = rownames(summary(fit$table)), risk.table.height = 0.25, pval.size = 6, ggtheme = theme_gray() + theme(plot.title = element_text(size= 18, hjust = 0.5)) + theme(legend.title = element_text(colour="black", size=15, face="bold")), break.time.by =50, risk.table.y.text.col = T, risk.table.y.text = FALSE, 
                                          legend.title = ..(input$Tab8_Download_Adjusted_Curves_Legend_Title), title = (..(input$Tab8_Download_Adjusted_Curves_Plot_Title)), font.main = c(18, "plain", "black"), font.x = c(15, "plain", "black"), font.y = c(15, "plain", "black"), font.legend = c(14, "plain", "black"), font.tickslab = c(12, "plain", "black"))
           })
       } else if(input$Tab8_Download_Adjusted_Curves_Select == "None Selected"){
           ggplot() + theme_void()
       } else {
           metaExpr({ Data <- ..(NewData())
           rownames(Data) <- do.call(paste,c(Data[c(..(input$Tab8_Adjusted_Curves_Select_Variable_1), ..(input$Tab8_Adjusted_Curves_Select_Variable_2))], sep="_"))
           fit <- survfit(..(CoxAssump()), newdata = Data[Data[,c(..(input$Tab8_Adjusted_Curves_Select_Variable_1))] %in% ..(input$Tab8_Download_Adjusted_Curves_Select),])
           survminer::ggsurvplot(fit, data = Data, censor.shape="", xlab=..(input$Tab8_Download_Adjusted_Curves_X_Axis_Title), ylab=..(input$Tab8_Download_Adjusted_Curves_Y_Axis_Title), size = 1, conf.int = ..(input$Tab8_Download_Adjusted_Curves_Display_CI), risk.table = ..(input$Tab8_Download_Adjusted_Curves_Display_Risk_Table), 
                                          legend = c(..(input$Tab8_Download_Adjusted_Curves_Legend_Position)), legend.labs = rownames(summary(fit$table)), risk.table.height = 0.25, pval.size = 6, ggtheme = theme_gray() + theme(plot.title = element_text(size= 18, hjust = 0.5)) + theme(legend.title = element_text(colour="black", size=15, face="bold")), break.time.by =50, risk.table.y.text.col = T, risk.table.y.text = FALSE, 
                                          legend.title = ..(input$Tab8_Download_Adjusted_Curves_Legend_Title), title = (..(input$Tab8_Download_Adjusted_Curves_Plot_Title)), font.main = c(18, "plain", "black"), font.x = c(15, "plain", "black"), font.y = c(15, "plain", "black"), font.legend = c(14, "plain", "black"), font.tickslab = c(12, "plain", "black"))
           })}
   })
   
   output$Pred3 = metaRender(renderPlot, { ..(OutVarPlot()) })
   
   # Download Button
   output$Tab8_Download_Adjusted_Curves_Plot <- downloadHandler(filename = function(){paste("Adjusted_Survival_Curve",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab8_Download_Adjusted_Curves_Plot_Width, height = input$Tab8_Download_Adjusted_Curves_Plot_Height)
       print(OutVarPlot())
       dev.off()})
   
   ## Tab 9 - Recursive partitioning Survival Trees
   # Survival Trees - Rpart an Ctree 
   
   # Select Inputs for both Rpart and Ctree
   observe({vchoicesRpart <- c(names(Whole_Data()), "None Selected")
   updateSelectizeInput(session, "Tab9_Rpart_Select_Variables", choices = vchoicesRpart, server = TRUE)
   updateSelectizeInput(session, "Tab9_Ctree_Select_Variables", choices = vchoicesRpart, server = TRUE)
   updateSelectizeInput(session, "Tab9_Rpart_Survival_Time", choices =  vchoicesRpart, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab9_Rpart_Event_Status", choices =  vchoicesRpart, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab9_Ctree_Survival_Time", choices =  vchoicesRpart, selected = "None Selected", server = TRUE)
   updateSelectizeInput(session, "Tab9_Ctree_Event_Status", choices =  vchoicesRpart, selected = "None Selected", server = TRUE)})
   
   ## Rpart 
   FormulaRpart <- metaReactive2({metaExpr({noquote(paste(..(input$Tab9_Rpart_Select_Variables), collapse="+")) })})
   
   output$RpartTreeForm = metaRender(renderPrint, { ..(FormulaRpart()) })
   
   # Rpart works when there is time/event information and at least 1 other piece of info 
   # Create Complete Case Data and Data where every predictor variable has at least 1 observation for patient
   Whole_Data_Rpart <- metaReactive2({
       if(input$Tab9_Rpart_Use_Complete_Cases_Only == TRUE){
           metaExpr({..(Whole_Data()) %>% filter(eval(parse(text = ..(input$Tab9_Rpart_Survival_Time))) > 0) %>% completeFun(data =., c(..(input$Tab9_Rpart_Survival_Time), ..(input$Tab9_Rpart_Event_Status), ..(input$Tab9_Rpart_Select_Variables))) })
       } else {
           metaExpr({..(Whole_Data()) %>% filter(eval(parse(text = ..(input$Tab9_Rpart_Survival_Time))) > 0) %>%  completeFun(data =., c(..(input$Tab9_Rpart_Event_Status)))})} }) 

   
   # Fit Rpart Tree (Arguments not yet used in formula include maxcompete, maxsurrogate, usesurrogate, surrogatestyle)
   pfit <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab9_Rpart_Select_Variables), "Please select variables to include in rpart survival tree"))
       if(input$Tab9_Rpart_Survival_Time == "None Selected" | input$Tab9_Rpart_Event_Status == "None Selected"){return(NULL)}
       else {
           metaExpr({rpart(paste("Surv(", "as.numeric(", ..(input$Tab9_Rpart_Survival_Time), ")", ",",  ..(input$Tab9_Rpart_Event_Status), ") ~ ", ..(FormulaRpart()), sep = ""), data = ..(Whole_Data_Rpart()), method =  "exp", model=TRUE,
                          control = rpart.control(minsplit = ..(input$Tab9_Rpart_Minsplit), minbucket = ..(input$Tab9_Rpart_Minbucket), cp = ..(input$Tab9_Rpart_Cp),
                                                  xval = ..(input$Tab9_Rpart_Xval), maxdepth = ..(input$Tab9_Rpart_Maxdepth)))})}})
   
   
   # Plot Rpart Tree - Can also Download it 
   RpartTreePlot_Re <- metaReactive2({if(is.null(pfit())){ggplot() + theme_void()}
       else{metaExpr({plot(partykit::as.party(..(pfit()))) })}})
   
   output$RpartTreePlot <- metaRender(renderPlot, { ..(RpartTreePlot_Re()) })
   
   # Download Button
   output$Tab9_Download_Rpart_Plot <- downloadHandler(filename = function(){paste("Rpart_Tree",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab9_Rpart_Plot_Width, height = input$Tab9_Rpart_Plot_Height)
       print(plot(partykit::as.party(pfit())))
       dev.off()})
   
   # Survival Curves for each Node in Rpart Tree -> Add Node to Dataframe 
   data_node_info <- metaReactive2({ metaExpr({..(Whole_Data_Rpart()) %>% mutate(Node_Rpart = as.factor(..(pfit())$where)) %>%
           data.frame(Time = .[[..(input$Tab9_Rpart_Survival_Time)]], Node = .[["Node_Rpart"]], Cen  = .[[..(input$Tab9_Rpart_Event_Status)]]) %>% select(Time, Node, Cen) })}) 

   Surv_Curve <-  metaReactive2({ metaExpr({survfit(Surv(as.numeric(Time), as.numeric(as.character(Cen))) ~ Node, data = ..(data_node_info())) })})
   
   PercentSurvPlotRpart <- metaReactive2({ 
       if(is.null(Whole_Data()) | input$Tab9_Rpart_Survival_Time  == "None Selected" | input$Tab9_Rpart_Event_Status  == "None Selected"){ggplot() + theme_void()}
       else{metaExpr({ggsurvplot(..(Surv_Curve()), censor.shape="", xlab=..(input$Tab9_Surv_Rpart_X_Axis_Title), ylab=..(input$Tab9_Surv_Rpart_Y_Axis_Title), data = ..(data_node_info()), size = 1,
                                 conf.int = ..(input$Tab9_Surv_Rpart_Display_CI), risk.table = ..(input$Tab9_Surv_Rpart_Display_Risk_Table), pval = ..(input$Tab9_Surv_Rpart_Display_Pval),
                                 legend = c(..(input$Tab9_Surv_Rpart_Legend_Position)), legend.labs = rownames(summary(..(Surv_Curve())$table)), risk.table.height = 0.25, pval.size = 6, ggtheme = theme_gray() + theme(plot.title = element_text(size= 18, hjust = 0.5)) + theme(legend.title = element_text(colour="black", size=15, face="bold")), break.time.by =50, risk.table.y.text.col = T, risk.table.y.text = FALSE, 
                                 legend.title = ..(input$Tab9_Surv_Rpart_Legend_Title), title = (..(input$Tab9_Surv_Rpart_Plot_Title)), font.main = c(18, "plain", "black"), font.x = c(15, "plain", "black"), font.y = c(15, "plain", "black"), font.legend = c(14, "plain", "black"), font.tickslab = c(12, "plain", "black")) })}})
   
   # Plot 
   output$Surv_Curve1 <- metaRender(renderPlot, { ..(PercentSurvPlotRpart()) })
   
   # Download Button
   output$Tab9_Download_Surv_Rpart_Plot <- downloadHandler(filename = function(){paste("Rpart_Tree_Curves",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab9_Surv_Rpart_Plot_Width, height = input$Tab9_Surv_Rpart_Plot_Height)
       print(PercentSurvPlotRpart())
       dev.off()})
   
   ## Ctree 
   FormulaCtree <- metaReactive2({ metaExpr({noquote(paste(..(input$Tab9_Ctree_Select_Variables), collapse="+")) })})
   
   output$CtreeTreeForm <- metaRender(renderPrint, { ..(FormulaCtree()) })
   
   Whole_Data_Ctree <- metaReactive2({
       if(input$Tab9_Ctree_Use_Complete_Cases_Only == TRUE){
           metaExpr({ ..(Whole_Data()) %>% completeFun(data = ., c(..(input$Tab9_Ctree_Survival_Time) , ..(input$Tab9_Ctree_Event_Status), ..(input$Tab9_Ctree_Select_Variables))) })
       } else {metaExpr({..(Whole_Data()) %>% completeFun(data = ., c(..(input$Tab9_Ctree_Event_Status)))})}})
   
   # Fit Ctree
   pfitctree <- metaReactive2({
       validate(need(!is.null(input$Input_Patient_File) | !is.null(input$Input_Sample_File) | !is.null(input$Input_CNA_File), "Please input clinical file, sample file and/or CNA file"))
       validate(need(!is.null(input$Tab9_Ctree_Select_Variables) & input$Tab9_Ctree_Select_Variables != "None Selected", "Please select variables to include in ctree survival tree"))
       if(input$Tab9_Ctree_Survival_Time == "None Selected" | input$Tab9_Ctree_Event_Status == "None Selected"){return(NULL)}
       else {
           metaExpr({partykit::ctree(as.formula(paste("Surv(", ..(input$Tab9_Ctree_Survival_Time), ",", ..(input$Tab9_Ctree_Event_Status), ") ~ ",  ..(FormulaCtree()), sep = "")), data =  ..(Whole_Data_Ctree()), 
                                    control = ctree_control(teststat = ..(input$Tab9_Ctree_Teststat), splitstat = ..(input$Tab9_Ctree_Splitstat),
                                                            testtype = ..(input$Tab9_Ctree_Testtype), alpha = ..(input$Tab9_Ctree_Alpha), 
                                                            minsplit = ..(input$Tab9_Ctree_Minsplit), minbucket = ..(input$Tab9_Ctree_Minbucket),
                                                            minprob = ..(input$Tab9_Ctree_Minprob), stump = ..(input$Tab9_Ctree_Stump), maxvar = ..(input$Tab9_Ctree_Maxvar),
                                                            maxdepth = ..(input$Tab9_Ctree_Maxdepth))) })}})
   
   # Plot Ctree Tree - Can also Download it 
   CtreeTreePlot_Re <- metaReactive2({if(is.null(pfitctree())){ggplot() + theme_void()}
       else{metaExpr({plot(..(pfitctree())) })}})
   
   output$CTreePlot <- metaRender(renderPlot, { ..(CtreeTreePlot_Re()) })
   
   # Download Button
   output$Tab9_Download_Ctree_Plot <- downloadHandler(filename = function(){paste("Ctree_Tree",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab9_Ctree_Plot_Width, height = input$Tab9_Ctree_Plot_Height)
       plot(pfitctree())
       dev.off()})
   
   # Survival Curves for each Node in Ctree Tree -> Add Node to Dataframe 
   data_node_info_ctree <-  metaReactive2({ metaExpr({..(Whole_Data_Ctree()) %>% mutate(Node_Ctree = as.factor(predict(..(pfitctree()), type="node"))) %>% 
           data.frame(Time = .[[..(input$Tab9_Ctree_Survival_Time)]], Node = .[["Node_Ctree"]], Cen  = .[[..(input$Tab9_Ctree_Event_Status)]]) %>% select(Time, Node, Cen) }) })
  
   Surv_Curvectree <- metaReactive2({ metaExpr({survfit(Surv(as.numeric(Time), as.numeric(as.character(Cen))) ~ Node, data = ..(data_node_info_ctree())) })})
   
   PercentSurvPlotCtree <-  metaReactive2({
       if(is.null(Whole_Data()) | input$Tab9_Ctree_Survival_Time  == "None Selected" | input$Tab9_Ctree_Event_Status  == "None Selected"){ggplot() + theme_void()}
       else{metaExpr({ggsurvplot(..(Surv_Curvectree()), censor.shape="", xlab=..(input$Tab9_Surv_Ctree_X_Axis_Title), ylab=..(input$Tab9_Surv_Ctree_Y_Axis_Title), data = ..(data_node_info_ctree()), size = 1, conf.int = ..(input$Tab9_Surv_Ctree_Display_CI), risk.table = ..(input$Tab9_Surv_Ctree_Display_Risk_Table), pval = ..(input$Tab9_Surv_Ctree_Display_Pval),
                                 legend = c(..(input$Tab9_Surv_Ctree_Legend_Position)), legend.labs = rownames(summary(..(Surv_Curvectree())$table)), risk.table.height = 0.25, pval.size = 6, ggtheme = theme_gray() + theme(plot.title = element_text(size= 18, hjust = 0.5)) + theme(legend.title = element_text(colour="black", size=15, face="bold")), break.time.by =50, risk.table.y.text.col = T, risk.table.y.text = FALSE, 
                                 legend.title = ..(input$Tab9_Surv_Ctree_Legend_Title), title = (..(input$Tab9_Surv_Ctree_Plot_Title)), font.main = c(18, "plain", "black"), font.x = c(15, "plain", "black"), font.y = c(15, "plain", "black"), font.legend = c(14, "plain", "black"), font.tickslab = c(12, "plain", "black")) })}})
   
   # Plot 
   output$Surv_CurveCtree <- metaRender(renderPlot, { ..(PercentSurvPlotCtree()) })
   
   # Download Button
   output$Tab9_Download_Surv_Ctree_Plot <- downloadHandler(filename = function(){paste("CTree_Curves",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab9_Surv_Ctree_Plot_Width, height = input$Tab9_Surv_Ctree_Plot_Height)
       print(PercentSurvPlotCtree())
       dev.off()})
   
   # Tab 10 - MAFTOOLS
   # Create MAF Object
   dataInputMAFPLOT <- metaReactive2({if(is.null(input$Input_Patient_File) & is.null(input$Input_Sample_File)) {
       validate(need(!is.null(input$Input_MAF_File), "Please input MAF file"))
       metaExpr({read.maf(maf = ..(dataInputMAF()))})} else{ metaExpr({read.maf(maf = ..(dataInputMAF()), clinicalData = ..(dataClinical()))})} })
   
   output$MAF1 <- metaRender(renderPrint, { ..(dataInputMAFPLOT()) })
   output$MAF2 <- metaRender(renderPrint, {getSampleSummary(..(dataInputMAFPLOT()))})
   output$MAF3 <- metaRender(renderPrint, {getGeneSummary(..(dataInputMAFPLOT()))})
   output$MAF4 <- metaRender(renderPrint, {getFields(..(dataInputMAFPLOT()))})
   output$MAFClin <- metaRender(renderPrint, {getClinicalData(..(dataInputMAFPLOT()))})
   
   ## Plots 
   sumMAF <- metaReactive2({
       if(is.null(input$Input_MAF_File)){ggplot() + theme_void() 
       } else{metaExpr({plotmafSummary(..(dataInputMAFPLOT()), rmOutlier = ..(input$Tab10_Summary_Remove_Outlier), addStat = ..(input$Tab10_Summary_Add_Stat), dashboard = ..(input$Tab10_Summary_Dashboard_Style), titvRaw = ..(input$Tab10_Summary_Plot_Fraction), top = ..(input$Tab10_Summary_Display_Top_Genes))})} })
   
   output$summaryMAF <- metaRender(renderPlot, {..(sumMAF())})
   
    # Download
    output$Tab10_Download_Summary_Plot <- downloadHandler(filename = function(){paste("MAF_Summary_Plot",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab10_Summary_Plot_Width, height = input$Tab10_Summary_Plot_Height)
        plotmafSummary(dataInputMAFPLOT(), rmOutlier = input$Tab10_Summary_Remove_Outlier, addStat = input$Tab10_Summary_Add_Stat, dashboard = input$Tab10_Summary_Dashboard_Style, titvRaw = input$Tab10_Summary_Plot_Fraction, top = input$Tab10_Summary_Display_Top_Genes)
        dev.off()})
    
    Onco <- metaReactive2({
        validate(need(!is.null(input$Input_MAF_File), "Please input MAF file"))
        if(is.null(input$Input_MAF_File)){return(ggplot() + theme_void())}
        else{ metaExpr({ oncoplot(..(dataInputMAFPLOT()), top = ..(input$Tab10_Oncoplot_Display_Top_Genes))})} })
    
    output$oncoplotMAF <- metaRender(renderPlot, {..(Onco())})
    
    output$Tab10_Download_Oncoplot_Plot <- downloadHandler(filename = function(){paste("Oncoplot",'.png',sep='')}, content = function(file){
        png(file, width = input$Tab10_Oncoplot_Plot_Width, height = input$Tab10_Oncoplot_Plot_Height)
        oncoplot(dataInputMAFPLOT(), top = input$Tab10_Oncoplot_Display_Top_Genes)
        dev.off()})
    
    observe({vchoices1 <- c(unique(dataInputMAF()[,input$Tab10_Lollipop_Gene_Name_Column]), "None Selected")
    updateSelectInput(session, "Tab10_Oncostrip_Select_Gene_1", choices = vchoices1, selected = vchoices1[1])
    updateSelectInput(session, "Tab10_Oncostrip_Select_Gene_2", choices = vchoices1, selected = vchoices1[2])
    updateSelectInput(session, "Tab10_Oncostrip_Select_Gene_3", choices = vchoices1, selected =  "None Selected")})
    
   OncoStrip <-  metaReactive2({ 
       validate(need(!is.null(input$Input_MAF_File), "Please input MAF file"))
       if(input$Tab10_Oncostrip_Select_Gene_1 != "None Selected" & input$Tab10_Oncostrip_Select_Gene_2 != "None Selected" & input$Tab10_Oncostrip_Select_Gene_3 == "None Selected"){
           metaExpr({ oncostrip(..(dataInputMAFPLOT()), genes = c(..(input$Tab10_Oncostrip_Select_Gene_1), ..(input$Tab10_Oncostrip_Select_Gene_2))) })
       } else if(input$Tab10_Oncostrip_Select_Gene_1 != "None Selected" & input$Tab10_Oncostrip_Select_Gene_2 != "None Selected" & input$Tab10_Oncostrip_Select_Gene_3 != "None Selected"){
           metaExpr({ oncostrip(..(dataInputMAFPLOT()), genes = c(..(input$Tab10_Oncostrip_Select_Gene_1), ..(input$Tab10_Oncostrip_Select_Gene_2), ..(input$Tab10_Oncostrip_Select_Gene_3))) })
       } }) 
   
   output$oncostripMAF <- metaRender(renderPlot, {..(OncoStrip())})
   
   output$Tab10_Download_Oncostrip_Plot <- downloadHandler(filename = function(){paste("Oncostrip",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab10_Oncostrip_Plot_Width, height = input$Tab10_Oncostrip_Plot_Height)
       oncostrip(dataInputMAFPLOT(), genes = c(input$Tab10_Oncostrip_Select_Gene_1, input$Tab10_Oncostrip_Select_Gene_2, input$Tab10_Oncostrip_Select_Gene_3))
       dev.off()})
   
    TandTPlot <- metaReactive2({ 
        validate(need(!is.null(input$Input_MAF_File), "Please input MAF file"))
        metaExpr({laml.Tab10_Summary_Plot_Fraction = titv(maf = ..(dataInputMAFPLOT()), plot = ..(input$Tab10_TT_Plot_Fraction), useSyn = ..(input$Tab10_TT_Include_Synonymous_Variants))
        plotTiTv(res = laml.Tab10_Summary_Plot_Fraction) }) })
    
    output$TandT <- metaRender(renderPlot, {..(TandTPlot())})
    
    output$Tab10_Download_TT_Plot <- downloadHandler(filename = function(){paste("Transitions_and_Transversions",'.png',sep='')}, content = function(file){
        png(file, width = Tab10_TT_Plot_Width, height = input$Tab10_TT_Plot_Height)
        laml.Tab10_Summary_Plot_Fraction = Tab10_Summary_Plot_Fraction(maf = dataInputMAFPLOT(), plot = input$Tab10_TT_Plot_Fraction, useSyn = input$Tab10_TT_Include_Synonymous_Variants)
        plotTiTv(res = laml.Tab10_Summary_Plot_Fraction) 
        dev.off()})
    
   # Lollipop plot 
   observe({vchoiceslol <- unique(dataInputMAF()[,input$Tab10_Lollipop_Gene_Name_Column])
   updateSelectInput(session, "Tab10_Lollipop_Select_Gene_1", choices = vchoiceslol, selected = vchoiceslol[1])
   updateSelectInput(session, "Tab10_Lollipop_Select_Gene_2", choices = vchoiceslol, selected = vchoiceslol[2])
   updateSelectInput(session, "Tab10_Lollipop_Select_Gene_3", choices = vchoiceslol, selected = vchoiceslol[3])})
   
   # Lollipop 1 
   
   Lol1 <- metaReactive2({
       validate(need(!is.null(input$Input_MAF_File), "Please input MAF file"))
       if(input$Tab10_Lollipop_Position_Label_1 == "None"){
           metaExpr({lollipopPlot(..(dataInputMAFPLOT()), gene = ..(input$Tab10_Lollipop_Select_Gene_1), AACol = 'HGVSp_Short', labPosSize = ..(input$Tab10_Lollipop_Label_Size_1),
                                           showMutationRate = ..(input$Tab10_Lollipop_Show_Mutation_Rate_1), showDomainLabel = ..(input$Tab10_Lollipop_Label_Domains_1), repel = ..(input$Tab10_Lollipop_Repel_Yes_or_No_1), showLegend = ..(input$Tab10_Lollipop_Show_Legend_1),
                                           legendTxtSize = ..(input$Tab10_Lollipop_Size_Legend_1), labPosAngle = ..(input$Tab10_Lollipop_Label_Angle_1), domainLabelSize = ..(input$Tab10_Lollipop_Label_Domains_Size_1)) })
       } else {
           metaExpr ({lollipopPlot(..(dataInputMAFPLOT()), gene = ..(input$Tab10_Lollipop_Select_Gene_1), AACol = 'HGVSp_Short', labelPos = ..(input$Tab10_Lollipop_Position_Label_1), labPosSize = ..(input$Tab10_Lollipop_Label_Size_1),
                                            showMutationRate = ..(input$Tab10_Lollipop_Show_Mutation_Rate_1), showDomainLabel = ..(input$Tab10_Lollipop_Label_Domains_1), repel = ..(input$Tab10_Lollipop_Repel_Yes_or_No_1), showLegend = ..(input$Tab10_Lollipop_Show_Legend_1),
                                            legendTxtSize = ..(input$Tab10_Lollipop_Size_Legend_1), labPosAngle = ..(input$Tab10_Lollipop_Label_Angle_1), domainLabelSize = ..(input$Tab10_Lollipop_Label_Domains_Size_1)) })}})
   
   output$lol1 <- metaRender(renderPlot, {..(Lol1())})
   
   # Download 
   output$Tab10_Download_Lollipop_Plot_1 <- downloadHandler(filename = function(){paste("Lollipop_Plot_1",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab10_Lollipop_Plot_Width_1, height = input$Tab10_Lollipop_Plot_Height_1)
       if(input$Tab10_Lollipop_Position_Label_1 == "None"){
           lollipopPlot(dataInputMAFPLOT(), gene = input$Tab10_Lollipop_Select_Gene_1, AACol = 'HGVSp_Short', labPosSize = input$Tab10_Lollipop_Label_Size_1,
                        showMutationRate = input$Tab10_Lollipop_Show_Mutation_Rate_1, showDomainLabel = input$Tab10_Lollipop_Label_Domains_1, repel = input$Tab10_Lollipop_Repel_Yes_or_No_1, showLegend = input$Tab10_Lollipop_Show_Legend_1,
                        legendTxtSize = input$Tab10_Lollipop_Size_Legend_1, labPosAngle = input$Tab10_Lollipop_Label_Angle_1, domainLabelSize = input$Tab10_Lollipop_Label_Domains_Size_1)
       } else {
           lollipopPlot(dataInputMAFPLOT(), gene = input$Tab10_Lollipop_Select_Gene_1, AACol = 'HGVSp_Short', labelPos = input$Tab10_Lollipop_Position_Label_1, labPosSize = input$Tab10_Lollipop_Label_Size_1,
                        showMutationRate = input$Tab10_Lollipop_Show_Mutation_Rate_1, showDomainLabel = input$Tab10_Lollipop_Label_Domains_1, repel = input$Tab10_Lollipop_Repel_Yes_or_No_1, showLegend = input$Tab10_Lollipop_Show_Legend_1,
                        legendTxtSize = input$Tab10_Lollipop_Size_Legend_1, labPosAngle = input$Tab10_Lollipop_Label_Angle_1, domainLabelSize = input$Tab10_Lollipop_Label_Domains_Size_1)} 
       dev.off()})
   
   # Lollipop 2 
   Lol2 <- metaReactive2({
       validate(need(!is.null(input$Input_MAF_File), "Please input MAF file"))
       if(input$Tab10_Lollipop_Position_Label_2== "None"){
           metaExpr({lollipopPlot(..(dataInputMAFPLOT()), gene = ..(input$Tab10_Lollipop_Select_Gene_2), AACol = 'HGVSp_Short', labPosSize = ..(input$Tab10_Lollipop_Label_Size_2),
                                           showMutationRate = ..(input$Tab10_Lollipop_Show_Mutation_Rate_2), showDomainLabel = ..(input$Tab10_Lollipop_Label_Domains_2), repel = ..(input$Tab10_Lollipop_Repel_Yes_or_No_2), showLegend = ..(input$Tab10_Lollipop_Show_Legend_2),
                                           legendTxtSize = ..(input$Tab10_Lollipop_Size_Legend_2), labPosAngle = ..(input$Tab10_Lollipop_Label_Angle_2), domainLabelSize = ..(input$Tab10_Lollipop_Label_Domains_Size_2)) })
       } else {
           metaExpr ({lollipopPlot(..(dataInputMAFPLOT()), gene = ..(input$Tab10_Lollipop_Select_Gene_2), AACol = 'HGVSp_Short', labelPos = ..(input$Tab10_Lollipop_Position_Label_2), labPosSize = ..(input$Tab10_Lollipop_Label_Size_2),
                                            showMutationRate = ..(input$Tab10_Lollipop_Show_Mutation_Rate_2), showDomainLabel = ..(input$Tab10_Lollipop_Label_Domains_2), repel = ..(input$Tab10_Lollipop_Repel_Yes_or_No_2), showLegend = ..(input$Tab10_Lollipop_Show_Legend_2),
                                            legendTxtSize = ..(input$Tab10_Lollipop_Size_Legend_2), labPosAngle = ..(input$Tab10_Lollipop_Label_Angle_2), domainLabelSize = ..(input$Tab10_Lollipop_Label_Domains_Size_2)) })}})
   
   output$lol2<- metaRender(renderPlot, {..(Lol2())})
   
   output$Tab10_Download_Lollipop_Plot_2 <- downloadHandler(filename = function(){paste("Lollipop_Plot_2",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab10_Lollipop_Plot_Width_2, height = input$Tab10_Lollipop_Plot_Height_2)
       if(input$Tab10_Lollipop_Position_Label_2 == "None"){
           lollipopPlot(dataInputMAFPLOT(), gene = input$Tab10_Lollipop_Select_Gene_2, AACol = 'HGVSp_Short', labPosSize = input$Tab10_Lollipop_Label_Size_2,
                        showMutationRate = input$Tab10_Lollipop_Show_Mutation_Rate_2, showDomainLabel = input$Tab10_Lollipop_Label_Domains_2, repel = input$Tab10_Lollipop_Repel_Yes_or_No_2, showLegend = input$Tab10_Lollipop_Show_Legend_2,
                        legendTxtSize = input$Tab10_Lollipop_Size_Legend_2, labPosAngle = input$Tab10_Lollipop_Label_Angle_2, domainLabelSize = input$Tab10_Lollipop_Label_Domains_Size_2)
       } else {
           lollipopPlot(dataInputMAFPLOT(), gene = input$Tab10_Lollipop_Select_Gene_2, AACol = 'HGVSp_Short', labelPos = input$Tab10_Lollipop_Position_Label_2, labPosSize = input$Tab10_Lollipop_Label_Size_2,
                        showMutationRate = input$Tab10_Lollipop_Show_Mutation_Rate_2, showDomainLabel = input$Tab10_Lollipop_Label_Domains_2, repel = input$Tab10_Lollipop_Repel_Yes_or_No_2, showLegend = input$Tab10_Lollipop_Show_Legend_2,
                        legendTxtSize = input$Tab10_Lollipop_Size_Legend_2, labPosAngle = input$Tab10_Lollipop_Label_Angle_2, domainLabelSize = input$Tab10_Lollipop_Label_Domains_Size_2)}
       dev.off()})
   
   # Lollipop 3
   Lol3 <- metaReactive2({
       validate(need(!is.null(input$Input_MAF_File), "Please input MAF file"))
       if(input$Tab10_Lollipop_Position_Label_3== "None"){
           metaExpr({lollipopPlot(..(dataInputMAFPLOT()), gene = ..(input$Tab10_Lollipop_Select_Gene_3), AACol = 'HGVSp_Short', labPosSize = ..(input$Tab10_Lollipop_Label_Size_3),
                                           showMutationRate = ..(input$Tab10_Lollipop_Show_Mutation_Rate_3), showDomainLabel = ..(input$Tab10_Lollipop_Label_Domains_3), repel = ..(input$Tab10_Lollipop_Repel_Yes_or_No_3), showLegend = ..(input$Tab10_Lollipop_Show_Legend_3),
                                           legendTxtSize = ..(input$Tab10_Lollipop_Size_Legend_3), labPosAngle = ..(input$Tab10_Lollipop_Label_Angle_3), domainLabelSize = ..(input$Tab10_Lollipop_Label_Domains_Size_3)) })
       } else {
           metaExpr ({lollipopPlot(..(dataInputMAFPLOT()), gene = ..(input$Tab10_Lollipop_Select_Gene_3), AACol = 'HGVSp_Short', labelPos = ..(input$Tab10_Lollipop_Position_Label_3), labPosSize = ..(input$Tab10_Lollipop_Label_Size_3),
                                            showMutationRate = ..(input$Tab10_Lollipop_Show_Mutation_Rate_3), showDomainLabel = ..(input$Tab10_Lollipop_Label_Domains_3), repel = ..(input$Tab10_Lollipop_Repel_Yes_or_No_3), showLegend = ..(input$Tab10_Lollipop_Show_Legend_3),
                                            legendTxtSize = ..(input$Tab10_Lollipop_Size_Legend_3), labPosAngle = ..(input$Tab10_Lollipop_Label_Angle_3), domainLabelSize = ..(input$Tab10_Lollipop_Label_Domains_Size_3)) })}})
   
   output$lol3 <- metaRender(renderPlot, {..(Lol3())})
   
   # Download
   output$Tab10_Download_Lollipop_Plot_3 <- downloadHandler(filename = function(){paste("Lollipop_Plot_3",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab10_Lollipop_Plot_Width_3, height = input$Tab10_Lollipop_Plot_Height_3)
       if(input$Tab10_Lollipop_Position_Label_3 == "None"){
           lollipopPlot(dataInputMAFPLOT(), gene = input$Tab10_Lollipop_Select_Gene_3, AACol = 'HGVSp_Short', labPosSize = input$Tab10_Lollipop_Label_Size_3,
                        showMutationRate = input$Tab10_Lollipop_Show_Mutation_Rate_3, showDomainLabel = input$Tab10_Lollipop_Label_Domains_3, repel = input$Tab10_Lollipop_Repel_Yes_or_No_3, showLegend = input$Tab10_Lollipop_Show_Legend_3,
                        legendTxtSize = input$Tab10_Lollipop_Size_Legend_3, labPosAngle = input$Tab10_Lollipop_Label_Angle_3, domainLabelSize = input$Tab10_Lollipop_Label_Domains_Size_3)
       } else {
           lollipopPlot(dataInputMAFPLOT(), gene = input$Tab10_Lollipop_Select_Gene_3, AACol = 'HGVSp_Short', labelPos = input$Tab10_Lollipop_Position_Label_3, labPosSize = input$Tab10_Lollipop_Label_Size_3,
                        showMutationRate = input$Tab10_Lollipop_Show_Mutation_Rate_3, showDomainLabel = input$Tab10_Lollipop_Label_Domains_3, repel = input$Tab10_Lollipop_Repel_Yes_or_No_3, showLegend = input$Tab10_Lollipop_Show_Legend_3,
                        legendTxtSize = input$Tab10_Lollipop_Size_Legend_3, labPosAngle = input$Tab10_Lollipop_Label_Angle_3, domainLabelSize = input$Tab10_Lollipop_Label_Domains_Size_3)}
       dev.off()})
   
   # Other Plots 
   # 1)
   
   Mut <- metaReactive2({
       validate(need(!is.null(input$Input_MAF_File), "Please input MAF file"))
       metaExpr({ laml.mutload = tcgaCompare(maf = ..(dataInputMAFPLOT()), cohortName = 'Our Data') })
   })
   
   output$Mutload <- metaRender(renderPlot, {..(Mut())})
   
   # Download 
   output$Tab10_Download_Mutation_Load_Plot <- downloadHandler(filename = function(){paste("Mutation_Load",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab10_Mutation_Load_Plot_Width, height = input$Tab10_Mutation_Load_Plot_Height)
       laml.mutload = tcgaCompare(maf = dataInputMAFPLOT(), cohortName = 'Our Data')
       dev.off()})
   
   
   
   # 2) 
   
   VAF <- metaReactive2({
       validate(need(!is.null(input$Input_MAF_File), "Please input MAF file"))
       metaExpr({ somaticInteractions(maf = ..(dataInputMAFPLOT()), top = ..(input$Tab10_SIP_Display_Top_Genes), pvalue = c(..(input$Tab10_SIP_Pval_Lower_Threshold), ..(input$Tab10_SIP_Pval_Upper_Threshold)))})
   })
   
   output$VAF1 <- metaRender(renderPlot, {..(VAF())})
   
   # Download 
   output$Tab10_Download_SIP_Plot <- downloadHandler(filename = function(){paste("Somatic_Interactions",'.png',sep='')}, content = function(file){
       png(file, width = input$Tab10_SIP_Plot_Width, height = input$Tab10_SIP_Plot_Height)
       somaticInteractions(maf = dataInputMAFPLOT(), top = input$Tab10_SIP_Display_Top_Genes, pvalue = c(input$Tab10_SIP_Pval_Lower_Threshold, input$Tab10_SIP_Pval_Upper_Threshold))
       dev.off()})
   
   
   ## Tab 11 Input Logs 
   log <- reactive({log_input <- input$.shinylogs_input
   return(log_input)})
   
   # Create nice dataframe that users can download to track activity on app
   Log_DataFrame <- reactive({
       
       if(is.null(log())){df <- data.frame(Timestamp=character(), Tab=character(), Name=character(), Value=character(), Binding=character(), stringsAsFactors=FALSE) 
       return(df)
       } else {df <- data.frame(Timestamp=character(), Tab=character(), Name=character(), Value=character(), Binding=character(), stringsAsFactors=FALSE)
       
       for(i in 1:length((log()$inputs))){
           
           col <- log()$inputs[[i]]
           
           # Input Files - Tab1 
           if(col$name %in% c("Input_Patient_File", "Input_Sample_File", "Input_CNA_File", "Input_MAF_File")){
               Vector_Row <- data.frame(col$timestamp, "Tab1", col$name, col$value[[1]][1], col$binding)
               names(Vector_Row) <- c("Timestamp", "Tab", "Name", "Value", "Binding")}
           else {
               Name <- col$name
               Tab <- unlist(strsplit(Name, "_"))
               if(length(Tab[Tab %in% c("Tab1", "Tab2", "Tab3", "Tab4", "Tab5", "Tab6", "Tab7", "Tab8", "Tab9", "Tab10", "Tab11")]) == 0){
                   Tab <- "Main Sidebar Menu"
               } else {
                   Tab <- Tab[Tab %in% c("Tab1", "Tab2", "Tab3", "Tab4", "Tab5", "Tab6", "Tab7", "Tab8", "Tab9", "Tab10", "Tab11")]
               }
               
               if(is.null(col$value)){
                   Vector_Row <- data.frame(col$timestamp, Tab, col$name, "NULL", col$binding)
                   names(Vector_Row) <- c("Timestamp", "Tab", "Name", "Value", "Binding")
               } else if (is.list(col$value)){
                   if(length(col$value) == 0){
                       Vector_Row <- data.frame(col$timestamp, Tab, col$name, "NULL", col$binding)
                       names(Vector_Row) <- c("Timestamp", "Tab", "Name", "Value", "Binding")
                       
                   } else {
                       Val <- c(col$value)
                       
                       names_value <- c()
                       for(q in 1:length(unlist(Val))){
                           names_value <- c(names_value, unlist(Val)[q])
                       }
                       names_value <- paste(names_value, collapse = " ")
                       
                       #     colname <- gsub("(Tab11_Display_Type).*", "\\1", col$name)
                       Vector_Row <- data.frame(col$timestamp, Tab, col$name, names_value, col$binding)
                       names(Vector_Row) <- c("Timestamp", "Tab", "Name", "Value", "Binding")}
               } else {
                   # colname <- gsub("(Tab11_Display_Type).*", "\\1", col$name)
                   Vector_Row <- data.frame(col$timestamp, Tab, col$name, col$value, col$binding)
                   names(Vector_Row) <- c("Timestamp", "Tab", "Name", "Value", "Binding")
               }
           }
           
           df <- rbind.data.frame(df, Vector_Row)}
       
       df$Tab <- factor(df$Tab, levels=c("Tab1", "Tab2", "Tab3", "Tab4", "Tab5", "Tab6", "Tab7", "Tab8", "Tab9", "Tab10", "Tab11", "Main Sidebar Menu"))
       
       
       if(input$Tab11_Remove_None_Log == T){df <- df %>% filter(Value %!in% c("", "None Selected", "NULL"))
       } 
       
       df <- df %>% filter(Binding %in% c(input$Tab11_Display_Type))
       df$Binding <- gsub("shinydashboard.", "", df$Binding)
       df$Binding <- gsub("shinyWidgets.", "", df$Binding)
       df$Binding <- gsub("shiny.", "", df$Binding)
       
       df <- df %>% filter(Tab != "Tab11")
       
       log_list <- c(input$Tab11_Order_Log_By)
       df1 <- df %>% arrange_at(.vars = log_list)
       
       return(df1)
       }
   })
   
   output$InputLog <-renderDataTable({Log_DataFrame()}, options = list(lengthMenu = c(10, 30, 50, 100), pageLength = 30, scrollX = TRUE, scrollY = "500px"))
   #  Download File
   output$Tab11_Download_Log = downloadHandler('Shiny_Log.txt', content = function(file) {
       write.table(Log_DataFrame(), file, sep=input$Tab11_Download_Log_Separator, quote = input$Tab11_Download_Log_Quote, row.names = input$Tab11_Download_Log_Row_Names)
   })    

    # R Script Download
    output$download_button_rscript <- downloadHandler(
        filename = "ggcode.zip", 
        content = function(file) {
            ggcode <- expandChain(
                "#' ---",
                "#' title: 'GNOSIS Session Code'",
                "#' ---",
                "#'",
                "#'",
                "#' Load up relevant libraries",
                quote(library(DT)), # Used to create scrollable datatables 
                quote(library(tidyverse)), # manipulate and select
                quote(library(fabricatr)), # function split_quantile
                quote(library(reshape2)), # Melt function
                quote(library(operator.tools)), # not in
                quote(library(RColorBrewer)), # Color palette 
                quote(library(rpart)), # Survival trees (rpart)
                quote(library(rpart.plot)), # Survival trees (rpart)
                quote(library(partykit)), # Survival trees (Ctree)
                quote(library(survival)), # Survival analysis
                quote(library(survminer)), # Survival analysis
                quote(library(stats)),
                quote(library(rstatix)),
                quote(library(DescTools)), # Dunns Test
                quote(library(car)), # leveneTest
                quote(library(R.utils)),
                quote(library(maftools)),
                "#'",
                "#'",
                "#' Complete Function",
                quote(completeFun <- function(data, desiredCols) {
                    completeVec <- complete.cases(data[, desiredCols])
                    return(data[completeVec, ])}),
                "#'",
                "#' Get Mode function",
                quote(getmode <- function(v) {uniqv <- unique(v)
                uniqv[which.max(tabulate(match(v, uniqv)))]}),
                "#'",
                "#'Function",
                quote(give.n <- function(x){return(c(y = median(x)*1.05, label = length(x)))}),
                "#'",
                "#' Tab 1: Load up clinical patient data and preview",
                "##' Note: Please replace temporary file path with path to uploaded file",
                if(!is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$ClinicalP()},
                "#'",
                "##' Get total number of columns in data",
                if(!is.null(input$Input_Patient_File)){output$TotalC()},
                "#'",
                "##' Get total number of rows in data",
                if(!is.null(input$Input_Patient_File)){output$TotalR()},
                "#'",
                "#'",
                "#' Tab 1: Load up clinical sample data and preview",
                "##' Note: Please replace temporary file path with path to uploaded file",
                if(!is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$ClinicalS()},
                "#'",
                "##' Get total number of columns in data",
                if(!is.null(input$Input_Sample_File)){output$TotalC1()},
                "#'",
                "##' Get total number of rows in data",
                if(!is.null(input$Input_Sample_File)){output$TotalR2()},
                "#'",
                "#'",
                "#' Tab 1: Merge patient/sample data and preview",
                if(is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$ClinicalAll()},
                if(is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$ClinicalAll()},
                if(!is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$ClinicalAll()},
                "#'",
                "#'",
                "#' Tab 1: Load up CNA data and preview",
                "##' Note: Please replace temporary file path with path to uploaded file",
                if(!is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CNA()},
                "#'",
                "##' Get total number of columns in data",
                if(!is.null(input$Input_CNA_File)){output$TotalCCNA()},
                "#'",
                "##' Get total number of rows in data",
                if(!is.null(input$Input_CNA_File)){output$TotalRCNA()},
                "#'",
                "#'",
                "#'Tab 1: Load up MAF data and preview",
                "##' Note: Please replace temporary file path with path to uploaded file",
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$MAF()},
                "#'",
                "##' Get total number of columns in data",
                if(!is.null(input$Input_MAF_File)){output$TotalCMAF()},
                "#'",
                "##' Get total number of rows in data",
                if(!is.null(input$Input_MAF_File)){output$TotalRMAF()}, 
                "#'",
                "#'",
                "#' Tab 2: Clinical variables datatable",
                if(((is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))) || (is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))) ||
                    (!is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines))))) && (input$Tab2_Clin_Column1_Variable != "None Selected" & input$Tab2_Clin_Column2_Variable == "None Selected" & input$Tab2_Clin_Column3_Variable == "None Selected" & input$Tab2_Clin_Column4_Variable == "None Selected" & input$Tab2_Clin_Column5_Variable == "None Selected")){Clinical_Table()},
                if(((is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))) || (is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))) ||
                    (!is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines))))) && (input$Tab2_Clin_Column1_Variable != "None Selected" & input$Tab2_Clin_Column2_Variable != "None Selected" & input$Tab2_Clin_Column3_Variable == "None Selected" & input$Tab2_Clin_Column4_Variable == "None Selected" & input$Tab2_Clin_Column5_Variable == "None Selected")){Clinical_Table()},
                if(((is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))) || (is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))) ||
                    (!is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines))))) && (input$Tab2_Clin_Column1_Variable != "None Selected" & input$Tab2_Clin_Column2_Variable != "None Selected" & input$Tab2_Clin_Column3_Variable != "None Selected" & input$Tab2_Clin_Column4_Variable == "None Selected" & input$Tab2_Clin_Column5_Variable == "None Selected")){Clinical_Table()},
                if(((is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))) || (is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))) ||
                    (!is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines))))) && (input$Tab2_Clin_Column1_Variable != "None Selected" & input$Tab2_Clin_Column2_Variable != "None Selected" & input$Tab2_Clin_Column3_Variable != "None Selected" & input$Tab2_Clin_Column4_Variable != "None Selected" & input$Tab2_Clin_Column5_Variable == "None Selected")){Clinical_Table()},
                if(((is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))) || (is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))) ||
                    (!is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines))))) && (input$Tab2_Clin_Column1_Variable != "None Selected" & input$Tab2_Clin_Column2_Variable != "None Selected" & input$Tab2_Clin_Column3_Variable != "None Selected" & input$Tab2_Clin_Column4_Variable != "None Selected" & input$Tab2_Clin_Column5_Variable != "None Selected")){Clinical_Table()},
                "#'",
                "#'",
                "#' Tab 2: CNA datatable",
                if(input$Tab2_CNA_Column1_Variable != "None Selected" & input$Tab2_CNA_Column2_Variable == "None Selected" & input$Tab2_CNA_Column3_Variable == "None Selected" & input$Tab2_CNA_Column4_Variable == "None Selected" & input$Tab2_CNA_Column5_Variable == "None Selected"){CNA_Table()},
                if(input$Tab2_CNA_Column1_Variable != "None Selected" & input$Tab2_CNA_Column2_Variable != "None Selected" & input$Tab2_CNA_Column3_Variable == "None Selected" & input$Tab2_CNA_Column4_Variable == "None Selected" & input$Tab2_CNA_Column5_Variable == "None Selected"){CNA_Table()},
                if(input$Tab2_CNA_Column1_Variable != "None Selected" & input$Tab2_CNA_Column2_Variable != "None Selected" & input$Tab2_CNA_Column3_Variable != "None Selected" & input$Tab2_CNA_Column4_Variable == "None Selected" & input$Tab2_CNA_Column5_Variable == "None Selected"){CNA_Table()},
                if(input$Tab2_CNA_Column1_Variable != "None Selected" & input$Tab2_CNA_Column2_Variable != "None Selected" & input$Tab2_CNA_Column3_Variable != "None Selected" & input$Tab2_CNA_Column4_Variable != "None Selected" & input$Tab2_CNA_Column5_Variable == "None Selected"){CNA_Table()},
                if(input$Tab2_CNA_Column1_Variable != "None Selected" & input$Tab2_CNA_Column2_Variable != "None Selected" & input$Tab2_CNA_Column3_Variable != "None Selected" & input$Tab2_CNA_Column4_Variable != "None Selected" & input$Tab2_CNA_Column5_Variable != "None Selected"){CNA_Table()},
                "#'",
                "#'",
                "#' Tab 2: MAF datatable",
                if(input$Tab2_MAF_Column1_Variable != "None Selected" & input$Tab2_MAF_Column2_Variable == "None Selected" & input$Tab2_MAF_Column3_Variable == "None Selected" & input$Tab2_MAF_Column4_Variable == "None Selected" & input$Tab2_MAF_Column5_Variable == "None Selected"){MAF_Table()},
                if(input$Tab2_MAF_Column1_Variable != "None Selected" & input$Tab2_MAF_Column2_Variable != "None Selected" & input$Tab2_MAF_Column3_Variable == "None Selected" & input$Tab2_MAF_Column4_Variable == "None Selected" & input$Tab2_MAF_Column5_Variable == "None Selected"){MAF_Table()},
                if(input$Tab2_MAF_Column1_Variable != "None Selected" & input$Tab2_MAF_Column2_Variable != "None Selected" & input$Tab2_MAF_Column3_Variable != "None Selected" & input$Tab2_MAF_Column4_Variable == "None Selected" & input$Tab2_MAF_Column5_Variable == "None Selected"){MAF_Table()},
                if(input$Tab2_MAF_Column1_Variable != "None Selected" & input$Tab2_MAF_Column2_Variable != "None Selected" & input$Tab2_MAF_Column3_Variable != "None Selected" & input$Tab2_MAF_Column4_Variable != "None Selected" & input$Tab2_MAF_Column5_Variable == "None Selected"){MAF_Table()},
                if(input$Tab2_MAF_Column1_Variable != "None Selected" & input$Tab2_MAF_Column2_Variable != "None Selected" & input$Tab2_MAF_Column3_Variable != "None Selected" & input$Tab2_MAF_Column4_Variable != "None Selected" & input$Tab2_MAF_Column5_Variable != "None Selected"){MAF_Table()},
                "#'",
                "#'",
                "#' Tab 3: Convert variables",
                "##' Check clinical variable types",
                if(is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$DataTypes()},
                if(is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$DataTypes()},
                if(!is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$DataTypes()},
                "#'",
                "##' Check clinical variable levels ",
                if(is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$DataLevels()},
                if(is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$DataLevels()},
                if(!is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$DataLevels()},
                "#'",
                "#'",
                "#' Tab 3: Subset data",
                "##' Filter and preview clinical data",
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableRecode1()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$TableRecode1()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableRecode1()},
                "#'",
                "##' Check selected variable levels",
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableLevels()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$TableLevels()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableLevels()},
                "#'",
                "#'",
                "#' Tab 3: Survival recoding",
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableRecode()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$TableRecode()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableRecode()},
                "#'",
                "#'", 
                "#'Tab 3: CNA selection and calculation",
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) &&
                   is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File)){output$TableCNACalc()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) &&
                   is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableCNACalc()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) &&
                   is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$TableCNACalc()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) &&
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableCNACalc()},
                "#'",
                "#'", 
                "#'Tab 3: CNA calculation save file preview",
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableData()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$TableData()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$TableData()},
          
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableData()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableData()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$TableData()},
            
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TableData()},
                "#'",
                "#'",
                "#'Tab 4: Exploratory Plots - Boxplot",
                if(isTRUE(input$Tab4_Boxplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Boxplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$plot3()},
                if(isTRUE(input$Tab4_Boxplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Boxplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$plot3()},
                if(isTRUE(input$Tab4_Boxplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Boxplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$plot3()},

                if(isTRUE(input$Tab4_Boxplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Boxplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$plot3()},
                if(isTRUE(input$Tab4_Boxplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Boxplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$plot3()},
                if(isTRUE(input$Tab4_Boxplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Boxplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$plot3()},
                
                if(isTRUE(input$Tab4_Boxplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Boxplot_Select_Y_Variable != "None Selected") &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$plot3()},
                "#'",
                "#'",
                "#'Tab 4: Exploratory Plots - Scatterplot",
                if(isTRUE(input$Tab4_Scatterplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Scatterplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Scatterplot1()},
                if(isTRUE(input$Tab4_Scatterplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Scatterplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Scatterplot1()},
                if(isTRUE(input$Tab4_Scatterplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Scatterplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Scatterplot1()},
                
                if(isTRUE(input$Tab4_Scatterplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Scatterplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Scatterplot1()},
                if(isTRUE(input$Tab4_Scatterplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Scatterplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Scatterplot1()},
                if(isTRUE(input$Tab4_Scatterplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Scatterplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Scatterplot1()},
                
                if(isTRUE(input$Tab4_Scatterplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Scatterplot_Select_Y_Variable != "None Selected") &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Scatterplot1()},
                "#'",
                "#'",
                "#'Tab 4: Exploratory Plots - Barplots",
                if(isTRUE(input$Tab4_Barplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Barplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Association3()},
                if(isTRUE(input$Tab4_Barplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Barplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Association3()},
                if(isTRUE(input$Tab4_Barplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Barplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Association3()},
                
                if(isTRUE(input$Tab4_Barplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Barplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Association3()},
                if(isTRUE(input$Tab4_Barplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Barplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Association3()},
                if(isTRUE(input$Tab4_Barplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Barplot_Select_Y_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Association3()},
                
                if(isTRUE(input$Tab4_Barplot_Select_X_Variable != "None Selected") && isTRUE(input$Tab4_Barplot_Select_Y_Variable != "None Selected") &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Association3()},
                "#'",
                "#'",
                "#'Tab 4: Exploratory Plots - Histogram",
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNAHist()}, 
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNAHist()}, 
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CNAHist()},
                
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNAHist()},
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNAHist()},
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNAHist()},
                
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNAHist()},
                "#'",
                "#'",
                "#'Tab 4: Exploratory Plots - Facetwrap Histogram",
                if(isTRUE(input$Tab4_Histogram_Select_Facet_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNAHist1()}, 
                if(isTRUE(input$Tab4_Histogram_Select_Facet_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNAHist1()}, 
                if(isTRUE(input$Tab4_Histogram_Select_Facet_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CNAHist1()},
                
                if(isTRUE(input$Tab4_Histogram_Select_Facet_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNAHist1()},
                if(isTRUE(input$Tab4_Histogram_Select_Facet_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNAHist1()},
                if(isTRUE(input$Tab4_Histogram_Select_Facet_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNAHist1()},
                
                if(isTRUE(input$Tab4_Histogram_Select_Facet_Variable  != "None Selected") &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNAHist1()},
                "#'",
                "#'",
                "#'Tab 4: Exploratory Plots - Density Plot",
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist()}, 
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNADist()}, 
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CNADist()},
                
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist()},
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist()},
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNADist()},
                
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && 
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist()}, 
                "#'",
                "#'", 
                "#'Tab 4: Exploratory Plots - Segmented Density Plot",
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist1()}, 
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNADist1()}, 
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CNADist1()},
                
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist1()},
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist1()},
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNADist1()},
                
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist1()},
                "#'",
                "#'", 
                "#'Tab 4: Exploratory Plots - FacetWrap Density Plot",
                if(isTRUE(input$Tab4_Density_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist2()}, 
                if(isTRUE(input$Tab4_Density_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNADist2()}, 
                if(isTRUE(input$Tab4_Density_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CNADist2()},
                
                if(isTRUE(input$Tab4_Density_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist2()},
                if(isTRUE(input$Tab4_Density_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist2()},
                if(isTRUE(input$Tab4_Density_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNADist2()},
                
                if(isTRUE(input$Tab4_Density_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNADist2()},
                "#'",
                "#'",
                "#'Tab 4: Exploratory Plots - Histogram and Density Plot",
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNABoth()}, 
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNABoth()}, 
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CNABoth()},
                
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNABoth()},
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNABoth()},
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNABoth()},
                
                if(isTRUE(input$Tab4_Select_Plot_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNABoth()},
                "#'",
                "#'",
                "#'Tab 4: Exploratory Plots - FacetWrap Histogram and Density Plot",
                if(isTRUE(input$Tab4_Both_Plot_Select_Facet_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNABoth1()}, 
                if(isTRUE(input$Tab4_Both_Plot_Select_Facet_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNABoth1()}, 
                if(isTRUE(input$Tab4_Both_Plot_Select_Facet_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CNABoth1()},
                
                if(isTRUE(input$Tab4_Both_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNABoth1()},
                if(isTRUE(input$Tab4_Both_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNABoth1()},
                if(isTRUE(input$Tab4_Both_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CNABoth1()},
                
                if(isTRUE(input$Tab4_Both_Plot_Select_Facet_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CNABoth1()},
                "#'",
                "#'",
                "#'Tab 5: Survival Plots - Clinical Variable KM Plots", 
                "##' KM Survival Plots",
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KM1()}, 
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KM1()}, 
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$KM1()},
                
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KM1()},
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KM1()},
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KM1()},
                
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KM1()},
                "#'",
                "##' Logrank Tests",
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrank()}, 
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMlogrank()}, 
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$KMlogrank()},
                
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrank()},
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrank()},
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMlogrank()},
                
                if(isTRUE(input$Tab5_KM_Clinical_Survival_Time  != "None Selected" & input$Tab5_KM_Clinical_Event_Status  != "None Selected" & input$Tab5_KM_Clinical_Select_Variable  != "None Selected") &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrank()},
                "#'",
                "#'",
                "#'Tab 5: Survival Plots - CNA Quartile KM Plots",
                "##' KM Survival Plots",
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$PercentSurv()}, 
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$PercentSurv()}, 
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$PercentSurv()},
                
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$PercentSurv()},
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$PercentSurv()},
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$PercentSurv()},
                
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$PercentSurv()},
                "#'",
                "##' Logrank Tests",
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrank1()}, 
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMlogrank1()}, 
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$KMlogrank1()},
                
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrank1()},
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrank1()},
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMlogrank1()},
                
                if(isTRUE(input$Tab5_KM_CNA_Survival_Time  != "None Selected" & input$Tab5_KM_CNA_Event_Status  != "None Selected" & input$Tab5_KM_CNA_Select_Variable  != "None Selected") &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrank1()},
                "#'",
                "#'",
                "#'Tab 5: Survival Plots - KM Plots for Treatment (Yes)",
                "##' KM Survival Plots",
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMR1()}, 
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMR1()}, 
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$KMR1()},
                
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMR1()},
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMR1()},
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMR1()},
                
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMR1()},
                "#'",
                "##' Logrank Tests",
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrankYes()}, 
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMlogrankYes()}, 
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$KMlogrankYes()},
                
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrankYes()},
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrankYes()},
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMlogrankYes()},
                
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrankYes()},
                "#'",
                "#'",
                "#'Tab 5: Survival Plots - KM Plots for Treatment (No)",
                "##' KM Survival Plots",
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMR2()}, 
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMR2()}, 
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$KMR2()},
                
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMR2()},
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMR2()},
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMR2()},
                
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMR2()},
                "#'",
                "##' Logrank Tests",
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrankNo()}, 
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMlogrankNo()}, 
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$KMlogrankNo()},
                
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrankNo()},
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrankNo()},
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KMlogrankNo()},
                
                if(isTRUE(input$Tab5_KM_Treatment_Survival_Time  != "None Selected" & input$Tab5_KM_Treatment_Event_Status != "None Selected" & input$Tab5_KM_Treatment_Select_Variable   != "None Selected" &  input$Tab5_KM_Treatment_Variable != "None Selected") && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KMlogrankNo()},
                "#'",
                "#'", 
                "#'Tab 6: Association Tests - Chi-Squared",
                "##' Individual Chi-squared tests", 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Chi_Code()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){Chi_Code()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){Chi_Code()},

                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Chi_Code()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Chi_Code()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){Chi_Code()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && 
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Chi_Code()},
                "#'",
                "##' Adjusted Chi-squared tests", 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat1Ad()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Cat1Ad()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Cat1Ad()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat1Ad()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat1Ad()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Cat1Ad()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat1Ad()},
                "#'",
                "#'", 
                "#'Tab 6: Association Tests - FET", 
                "##' Individual FET", 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){F_Code()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){F_Code()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){F_Code()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){F_Code()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){F_Code()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){F_Code()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){F_Code()},
                "#'",
                "##' Adjusted FET", 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat3Ad()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Cat3Ad()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Cat3Ad()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat3Ad()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat3Ad()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Cat3Ad()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat3Ad()},
                "#'",
                "#'", 
                "#'Tab 6: Association Tests - Simulated FET",
                "##' Individual Simulated FET", 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){SimF_Code()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){SimF_Code()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){SimF_Code()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){SimF_Code()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){SimF_Code()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){SimF_Code()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){SimF_Code()},
                "#'",
                "##' Adjusted Simulated FET", 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat2Ad()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Cat2Ad()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Cat2Ad()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat2Ad()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat2Ad()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Cat2Ad()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab6_Select_Categorical_Variable_2) && input$Tab6_Select_Categorical_Variable_2 != "None Selected" && input$Tab6_Select_Categorical_Variable_1 != "None Selected" &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Cat2Ad()},
                "#'",
                "#'",
                "#'Tab 6: Association Tests - ANOVA Assumptions",
                "##' Levene's Test",
                if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Levene_Code()}, 
                if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){Levene_Code()}, 
                if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){Levene_Code()},
                
                if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Levene_Code()},
                if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Levene_Code()},
                if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){Levene_Code()},
                
                if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Levene_Code()},
                "#'",
                "##' Fligner test",
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected"  && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Fligner_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected"  && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){Fligner_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected"  && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){Fligner_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected"  && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Fligner_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected"  && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Fligner_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected"  && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){Fligner_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                    !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                    !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                    !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Fligner_Code()},
                 "#'",
                 "##' Shapiro Test",
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Shapiro_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){Shapiro_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){Shapiro_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Shapiro_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Shapiro_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){Shapiro_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                    !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                    !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                    !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){Shapiro_Code()},
                 "#'",
                 "#'", 
                 "#'Tab 6: Association Tests - ANOVA",
                 "##' Individual ANOVA", 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){ANOVA_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){ANOVA_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){ANOVA_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){ANOVA_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){ANOVA_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){ANOVA_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                    !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                    !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                    !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){ANOVA_Code()},
                 "#'",
                 "##' Adjusted ANOVA", 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$ANOVAAd()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$ANOVAAd()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$ANOVAAd()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$ANOVAAd()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$ANOVAAd()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$ANOVAAd()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                    !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                    !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                    !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$ANOVAAd()},
                 "#'",
                 "#'",
                 "#'Tab 6: Association Tests - Kruskal-Wallis",
                 "##' Individual Kruskal-Wallis", 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){KW_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){KW_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){KW_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){KW_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){KW_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){KW_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                    !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                    !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                    !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){KW_Code()},
                 "#'",
                 "##' Adjusted Kruskal-Wallis", 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KWAd()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KWAd()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$KWAd()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KWAd()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KWAd()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$KWAd()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && 
                    !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                    !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                    !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$KWAd()},
                 "#'",
                 "#'",
                 "#'Tab 6: Association Tests - Pairwise Comparisons", 
                 "##' Pairwise t-test",
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){PWT_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){PWT_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){PWT_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){PWT_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){PWT_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){PWT_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                    !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                    !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                    !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){PWT_Code()},
                 "#'",
                 "##' Pairwise Dunn's Test",
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){PWD_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){PWD_Code()}, 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){PWD_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){PWD_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){PWD_Code()},
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){PWD_Code()},
                 
                 if(!is.null(input$Tab6_Select_Continuous_Variable_1) && input$Tab6_Select_Continuous_Variable_1 != "None Selected" && input$Tab6_Select_Categorical_Variable_3 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                    !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                    !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                    !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){PWD_Code()},
                "#'",
                "#'",
                "#'Tab 7: Cox PH models - Univariate Cox Models",
                "##' Individual univariate Cox models", 
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CoxModelOut()}, 
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CoxModelOut()}, 
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CoxModelOut()},

                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CoxModelOut()},
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CoxModelOut()},
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CoxModelOut()},
                
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CoxModelOut()},
                "#'",
                "##' Adjusted univariate Cox models", 
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$UniAdjusted()}, 
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$UniAdjusted()}, 
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$UniAdjusted()},
                 
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$UniAdjusted()},
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$UniAdjusted()},
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$UniAdjusted()},
                
                if(!is.null(input$Tab7_Univariate_Cox_Select_Variables) && input$Tab7_Univariate_Cox_Survival_Time != "None Selected" && input$Tab7_Univariate_Cox_Event_Status  != "None Selected" && input$Tab7_Univariate_Cox_Select_Variables != "None Selected" && 
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$UniAdjusted()},
                "#'",
                "#'", 
                "#'Tab 7: Cox PH models - Multivariable Cox Models",
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CoxModelMultiOut()}, 
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CoxModelMultiOut()}, 
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CoxModelMultiOut()},
                
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CoxModelMultiOut()},
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CoxModelMultiOut()},
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CoxModelMultiOut()},
                
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CoxModelMultiOut()},
                
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Waldtestid()}, 
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Waldtestid()}, 
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Waldtestid()},
                 
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Waldtestid()},
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Waldtestid()},
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Waldtestid()},
                
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Waldtestid()},
                
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$LRTid()}, 
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$LRTid()}, 
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$LRTid()},
                
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$LRTid()},
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$LRTid()},
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$LRTid()},
                
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && 
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$LRTid()},
                
                if( !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Logrid()}, 
                if( !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Logrid()}, 
                if( !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Logrid()},
                
                if( !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Logrid()},
                if( !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Logrid()},
                if( !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&  is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Logrid()},
                
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && 
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Logrid()},
                "#'",
                "#'",
                "#'Tab 7: Cox PH models - Multivariable Cox Model Assumptions",
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$AssumptionsCox()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$AssumptionsCox()}, 
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$AssumptionsCox()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$AssumptionsCox()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$AssumptionsCox()},
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$AssumptionsCox()},
                
                if(!is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && 
                   !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && 
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$AssumptionsCox()},
                "#'",
                "#'",
                "#'Tab 8: Adjusted Survival Curves - New Data",
                if(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$preddata()}, 
                if(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$preddata()}, 
                if(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$preddata()},
                
                if(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$preddata()},
                if(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$preddata()},
                if(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$preddata()},
                
                if(!is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$preddata()},
                "#'",
                "#'",
                "#'Tab 8: Adjusted Survival Curves - All Adjusted Survival Curves",
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Pred1()}, 
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Pred1()}, 
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Pred1()},
                
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Pred1()},
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Pred1()},
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Pred1()},
                
                if(!is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" &&
                   !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Pred1()},
                "#'",
                "#'",
                "#'Tab 8: Adjusted Survival Curves - Single Adjusted Survival Curves",
                if(input$Tab8_Download_Adjusted_Curves_Select != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Pred3()}, 
                if(input$Tab8_Download_Adjusted_Curves_Select != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Pred3()}, 
                if(input$Tab8_Download_Adjusted_Curves_Select != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Pred3()},
                
                if(input$Tab8_Download_Adjusted_Curves_Select != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Pred3()},
                if(input$Tab8_Download_Adjusted_Curves_Select != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Pred3()},
                if(input$Tab8_Download_Adjusted_Curves_Select != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) & !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Pred3()},
                
                if(input$Tab8_Download_Adjusted_Curves_Select != "None Selected" &&
                   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && !is.null(input$Tab7_Multivariable_Cox_Select_Variables) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_1) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_2) && !is.null(input$Tab7_Multivariable_Cox_Select_Interaction_Variables_3) && input$Tab7_Multivariable_Cox_Survival_Time != "None Selected" && input$Tab7_Multivariable_Cox_Event_Status  != "None Selected" && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_1) && !is.null(input$Tab8_Adjusted_Curves_Select_Variable_2) && !is.null(input$Tab8_Adjusted_Curves_Select_Constant_Variable) && input$Tab8_Adjusted_Curves_Select_Variable_1  != "None Selected" && input$Tab8_Adjusted_Curves_Select_Variable_2 != "None Selected" && 
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Pred3()}, 
                "#'",
                "#'", 
                "#'Tab 9: Recursive Partitioning Survival Trees - Rpart",
                "##' Rpart Tree Formula",
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$RpartTreeForm()}, 
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$RpartTreeForm()}, 
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$RpartTreeForm()},
                
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$RpartTreeForm()},
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$RpartTreeForm()},
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$RpartTreeForm()},
                
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" && !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$RpartTreeForm()},
                "#'",
                "##' Rpart Tree Plot",
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){RpartTreePlot_Re()}, 
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){RpartTreePlot_Re()}, 
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){RpartTreePlot_Re()},
                
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){RpartTreePlot_Re()},
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){RpartTreePlot_Re()},
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){RpartTreePlot_Re()},
                
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){RpartTreePlot_Re()},
                "#'",
                "##' Rpart Tree Survival Curves",
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Surv_Curve1()}, 
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Surv_Curve1()}, 
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Surv_Curve1()},
                
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Surv_Curve1()},
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Surv_Curve1()},
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Surv_Curve1()},
                
                if(!is.null(input$Tab9_Rpart_Select_Variables) && input$Tab9_Rpart_Survival_Time  != "None Selected" && input$Tab9_Rpart_Event_Status  != "None Selected" &&   !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Surv_Curve1()},
                "#'",
                "#'", 
                "#'Tab 9: Recursive Partitioning Survival Trees - Ctree",
                "##' Ctree Formula",
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CtreeTreeForm()}, 
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CtreeTreeForm()}, 
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$CtreeTreeForm()},
                
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CtreeTreeForm()},
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CtreeTreeForm()},
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$CtreeTreeForm()},
                
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && 
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$CtreeTreeForm()},
                "#'", 
                "##' Ctree Plot",
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){ CtreeTreePlot_Re()}, 
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){ CtreeTreePlot_Re()}, 
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){ CtreeTreePlot_Re()},
                
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){ CtreeTreePlot_Re()},
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){ CtreeTreePlot_Re()},
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){ CtreeTreePlot_Re()},
                
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && 
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){ CtreeTreePlot_Re()},
                "#'", 
                "##' Ctree Survival Curves",
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Surv_CurveCtree()}, 
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Surv_CurveCtree()}, 
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines)))){output$Surv_CurveCtree()},
                
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_CNA_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Surv_CurveCtree()},
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Sample_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Surv_CurveCtree()},
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) && is.null(input$Input_Patient_File) && !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Surv_CurveCtree()},
                
                if(!is.null(input$Tab9_Ctree_Select_Variables) && input$Tab9_Ctree_Select_Variables != "None Selected" && input$Tab9_Ctree_Survival_Time != "None Selected" && input$Tab9_Ctree_Event_Status != "None Selected" &&  !is.null(input$Tab3_Subset_Variable_Levels_1) && !is.null(input$Tab3_Subset_Variable_Levels_2) && !is.null(input$Tab3_Subset_Variable_Levels_3) &&
                   !is.null(input$Input_CNA_File) && isTRUE(ncol(input$Input_CNA_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_CNA_File$datapath, header = input$Tab1_CNA_Header_Yes_or_No, sep = input$Tab1_CNA_Separator, quote = input$Tab1_CNA_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_CNA_Skip_Lines))) && 
                   !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && 
                   !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Surv_CurveCtree()},
                "#'",
                "#'",
                "#'Tab 10: Maftools - Summary", 
                "##' MAF Summary",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$MAF1()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$MAF1()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$MAF1()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$MAF1()},
                "#'",
                 "##' Sample Summary",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$MAF2()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$MAF2()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$MAF2()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$MAF2()},
                 "#'",
                 "##' Gene Summary",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$MAF3()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$MAF3()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$MAF3()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$MAF3()},
                 "#'",
                 "##' Get Fields",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$MAF4()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$MAF4()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$MAF4()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$MAF4()},
                 "#'",
                 "##' Associated Clinical Data",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$MAFClin()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$MAFClin()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$MAFClin()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$MAFClin()},
                 "#'",
                 "#'",
                "#'Tab 10: Maftools - Plots",
                "##' MAF Summary Plot",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$summaryMAF()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$summaryMAF()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$summaryMAF()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$summaryMAF()},
                "#'",
                "##' Oncoplot",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$oncoplotMAF()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$oncoplotMAF()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$oncoplotMAF()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$oncoplotMAF()},
                "#'",
                "##' Oncostrip",
                if(input$Tab10_Oncostrip_Select_Gene_1 != "None Selected" && input$Tab10_Oncostrip_Select_Gene_2 != "None Selected" && is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$oncostripMAF()},
                if(input$Tab10_Oncostrip_Select_Gene_1 != "None Selected" && input$Tab10_Oncostrip_Select_Gene_2 != "None Selected" && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$oncoplotMAF()},
                if(input$Tab10_Oncostrip_Select_Gene_1 != "None Selected" && input$Tab10_Oncostrip_Select_Gene_2 != "None Selected" && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$oncostripMAF()},
                if(input$Tab10_Oncostrip_Select_Gene_1 != "None Selected" && input$Tab10_Oncostrip_Select_Gene_2 != "None Selected" && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$oncostripMAF()},
                "#'",
                "##' Transitions and Transversions",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$TandT()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TandT()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$TandT()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$TandT()},
                "#'",
                "##' Lollipop plot 1",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$lol1()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$lol1()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$lol1()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$lol1()},
                "#'",
                "##' Lollipop plot 2",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$lol2()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$lol2()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$lol2()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$lol2()},
                "#'",
                "##' Lollipop plot 3",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$lol3()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$lol3()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$lol3()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$lol3()},
                "#'",
                "##' Mutation load plot",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$Mutload()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Mutload()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$Mutload()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$Mutload()},
                "#'",
                "##' Somatic interactions",
                if(is.null(input$Input_Sample_File) && is.null(input$Input_Patient_File) && !is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines)))){output$VAF1()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Sample_File) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$VAF1()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && is.null(input$Input_Patient_File) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines)))){output$VAF1()},
                if(!is.null(input$Input_MAF_File) && isTRUE(ncol(input$Input_MAF_File) > 1) && isTRUE("Hugo_Symbol" %in% colnames(read.csv(input$Input_MAF_File$datapath, header = input$Tab1_MAF_Header_Yes_or_No, sep = input$Tab1_MAF_Separator, quote = input$Tab1_MAF_Quote, check.names = F, na.strings=c(""," ","NA"), skip=input$Tab1_MAF_Skip_Lines))) && !is.null(input$Input_Sample_File) && isTRUE(ncol(input$Input_Sample_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Sample_File$datapath, header = input$Tab1_Sample_Header_Yes_or_No, sep = input$Tab1_Sample_Separator, quote = input$Tab1_Sample_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Sample_Skip_Lines))) && !is.null(input$Input_Patient_File) && isTRUE(ncol(input$Input_Patient_File) > 2) && isTRUE("PATIENT_ID" %in% colnames(read.csv(input$Input_Patient_File$datapath, header = input$Tab1_Clin_Header_Yes_or_No, sep = input$Tab1_Clin_Separator, quote = input$Tab1_Clin_Quote, na.strings=c(""," ","NA"), skip = input$Tab1_Clin_Skip_Lines)))){output$VAF1()}
           )
            buildScriptBundle(ggcode, file, render = FALSE)
        }
    )
   })



